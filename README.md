Project Overview
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Install

``` sh
pip install LTBP
```

> coming soon private github pypi token to allow for easy install

## LTBP Use Cases

In 2023/24 this project plans on being the replacement to LTR, which
historically was used to help subpress media dollar spend for guest
segments.

The details of this use case will be filled out as the 22/23 winter
season rolls through as we gear up for another year of pass sales.

## LTBP Result Overview

Current Fiscal Season Results:

Development Results:

- MACHINLEARNINGOUTPUTS.DEV.LTBP_PREDICTIONS

> Note: Development results will be something that we move around as
> more scale begins to happen, but that isnâ€™t solved as of now.

Production Snowflake Table:

- MACHINLEARNINGOUTPUTS.LTBP.LTBP_PREDICTIONS

Total Predictions:

<!-- {{total_preds}} -->

``` python
total_preds
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TOTAL_POP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14759852</td>
    </tr>
  </tbody>
</table>
</div>

Example of Prediction Table Output:

<!-- {{example_output}} -->

``` python
example_output
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ECID</th>
      <th>PROBABILITY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>61068721</td>
      <td>0.038751</td>
    </tr>
    <tr>
      <th>1</th>
      <td>130053505</td>
      <td>0.492399</td>
    </tr>
    <tr>
      <th>2</th>
      <td>49940527</td>
      <td>0.051959</td>
    </tr>
    <tr>
      <th>3</th>
      <td>74112965</td>
      <td>0.034402</td>
    </tr>
    <tr>
      <th>4</th>
      <td>32759861</td>
      <td>0.004805</td>
    </tr>
    <tr>
      <th>5</th>
      <td>57941408</td>
      <td>0.002742</td>
    </tr>
    <tr>
      <th>6</th>
      <td>13674145</td>
      <td>0.065647</td>
    </tr>
    <tr>
      <th>7</th>
      <td>60909761</td>
      <td>0.009027</td>
    </tr>
    <tr>
      <th>8</th>
      <td>97172783</td>
      <td>0.002126</td>
    </tr>
    <tr>
      <th>9</th>
      <td>131977740</td>
      <td>0.109056</td>
    </tr>
  </tbody>
</table>
</div>

Schema:

| Variable Name | Description                                                                  |
|:--------------|:-----------------------------------------------------------------------------|
| ECID          | Customer Key                                                                 |
| PROBABILITY   | The estimated probability that this ECID will buy a Pass in this Fiscal Year |

Label Logic:

LTBP is composed of five bins low, low-med, medium, med-high high. In
the past, there was an attempt to optimize the return rate to be heavy
in low, but for simplicity and scalability of this project, DSDE decided
to use NTILE, which creates equal buckets for the five labeled groups.

<!-- {{NTILE_breakdown}} -->

``` python
NTILE_breakdown
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LIKELIHOODTOBUYPASSLABEL</th>
      <th>TOTAL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>High</td>
      <td>2951970</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Medium</td>
      <td>2951970</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Med-High</td>
      <td>2951970</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Low-Med</td>
      <td>2951971</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Low</td>
      <td>2951971</td>
    </tr>
  </tbody>
</table>
</div>

Example of what the output looks like with ntile(s) assoicated with the
raw probability output <!-- {{example_of_ntile}} -->

``` python
example_of_ntile
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ECID</th>
      <th>PROBABILITY</th>
      <th>NTILE_5</th>
      <th>LIKELIHOODTOBUYPASSLABEL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>131035762</td>
      <td>0.999566</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>1</th>
      <td>112628819</td>
      <td>0.999552</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>2</th>
      <td>138473097</td>
      <td>0.999544</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>3</th>
      <td>102515974</td>
      <td>0.999541</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>4</th>
      <td>136960602</td>
      <td>0.999527</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>5</th>
      <td>131977201</td>
      <td>0.999525</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>6</th>
      <td>137118754</td>
      <td>0.999525</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>7</th>
      <td>137071085</td>
      <td>0.999522</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>8</th>
      <td>131795763</td>
      <td>0.999518</td>
      <td>5</td>
      <td>High</td>
    </tr>
    <tr>
      <th>9</th>
      <td>58857511</td>
      <td>0.999517</td>
      <td>5</td>
      <td>High</td>
    </tr>
  </tbody>
</table>
</div>

**Current Season 2022/23 Results**
<!-- **Current Season {{season_year}} Results** -->
<!-- {{current_season_results}} -->

``` python
current_season_results
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LIKELIHOODTOBUYPASSLABEL</th>
      <th>RECORDS</th>
      <th>FY22_PASSHOLDER</th>
      <th>NOPASSPURCHASE</th>
      <th>FY22CONVERSIONRATE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>High</td>
      <td>2951970</td>
      <td>1108113</td>
      <td>1843857</td>
      <td>0.375381</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Med-High</td>
      <td>2951970</td>
      <td>69263</td>
      <td>2882707</td>
      <td>0.023463</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Medium</td>
      <td>2951970</td>
      <td>30164</td>
      <td>2921806</td>
      <td>0.010218</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Low-Med</td>
      <td>2951971</td>
      <td>24155</td>
      <td>2927816</td>
      <td>0.008183</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Low</td>
      <td>2951971</td>
      <td>12742</td>
      <td>2939229</td>
      <td>0.004316</td>
    </tr>
  </tbody>
</table>
</div>

## Model Specifics

Description of LTBP Production Model:

<!-- - {{models_dict[experiment_name]['description']}} -->

``` python
models_dict[experiment_name]['description']
```

    'Standard baseline xgb_hyperopt approach status quo of LTBP of the past'

Model Name in side of LTBP Repo:

<!-- - {{models_dict[experiment_name]['model_trainer']}} -->

``` python
models_dict[experiment_name]['model_trainer']
```

    'train_xgb'
