<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="This is how to do everything your gitlab pipeline will do locally using command line syntax">

<title>LTBP - Use Your CLI Commands</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="LTBP - Use Your CLI Commands">
<meta property="og:description" content="This is how to do everything your gitlab pipeline will do locally using command line syntax">
<meta property="og:site-name" content="LTBP">
<meta name="twitter:title" content="LTBP - Use Your CLI Commands">
<meta name="twitter:description" content="This is how to do everything your gitlab pipeline will do locally using command line syntax">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">LTBP</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Use Your CLI Commands</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Project Overview</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Tutorials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_preparation_example.html" class="sidebar-item-text sidebar-link">Data Creation Process</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeling_example.html" class="sidebar-item-text sidebar-link">Iterate Upon a Model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calling_library_cli.html" class="sidebar-item-text sidebar-link active">Use Your CLI Commands</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Library Scripts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_creation_script.html" class="sidebar-item-text sidebar-link">Data Creation Script</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeling_script.html" class="sidebar-item-text sidebar-link">Modeling Script</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_script.html" class="sidebar-item-text sidebar-link">Inference Script</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Library Functions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_utils.html" class="sidebar-item-text sidebar-link">Data Utils</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_utilities.html" class="sidebar-item-text sidebar-link">Model Utils</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.html" class="sidebar-item-text sidebar-link">Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_utilities_custom.html" class="sidebar-item-text sidebar-link">Model Utils</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_utilities.html" class="sidebar-item-text sidebar-link">Inference Utils</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#yaml-file-creations-base-query-for-feature-store-call" id="toc-yaml-file-creations-base-query-for-feature-store-call" class="nav-link active" data-scroll-target="#yaml-file-creations-base-query-for-feature-store-call">Yaml File Creations &amp; Base Query For Feature Store Call</a>
  <ul class="collapse">
  <li><a href="#create-base-feature-store-call" id="toc-create-base-feature-store-call" class="nav-link" data-scroll-target="#create-base-feature-store-call">Create Base Feature Store Call</a></li>
  <li><a href="#model-features-yamldictionary" id="toc-model-features-yamldictionary" class="nav-link" data-scroll-target="#model-features-yamldictionary">Model Features Yaml/Dictionary</a></li>
  <li><a href="#udf-inputs-yamldictionary" id="toc-udf-inputs-yamldictionary" class="nav-link" data-scroll-target="#udf-inputs-yamldictionary">UDF Inputs Yaml/Dictionary</a></li>
  <li><a href="#etl-yamldictionary" id="toc-etl-yamldictionary" class="nav-link" data-scroll-target="#etl-yamldictionary">ETL Yaml/Dictionary</a></li>
  <li><a href="#model-yamldictionary" id="toc-model-yamldictionary" class="nav-link" data-scroll-target="#model-yamldictionary">Model Yaml/Dictionary</a></li>
  <li><a href="#result" id="toc-result" class="nav-link" data-scroll-target="#result">Result</a></li>
  </ul></li>
  <li><a href="#data-set-creation" id="toc-data-set-creation" class="nav-link" data-scroll-target="#data-set-creation">Data Set Creation</a>
  <ul class="collapse">
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  </ul></li>
  <li><a href="#train-model" id="toc-train-model" class="nav-link" data-scroll-target="#train-model">Train Model</a>
  <ul class="collapse">
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1">Results</a></li>
  </ul></li>
  <li><a href="#infer-model-results" id="toc-infer-model-results" class="nav-link" data-scroll-target="#infer-model-results">Infer Model Results</a>
  <ul class="collapse">
  <li><a href="#results-2" id="toc-results-2" class="nav-link" data-scroll-target="#results-2">Results</a></li>
  </ul></li>
  <li><a href="#model-promotion" id="toc-model-promotion" class="nav-link" data-scroll-target="#model-promotion">Model Promotion</a></li>
  <li><a href="#production-level-run" id="toc-production-level-run" class="nav-link" data-scroll-target="#production-level-run">Production Level Run</a>
  <ul class="collapse">
  <li><a href="#results-3" id="toc-results-3" class="nav-link" data-scroll-target="#results-3">Results</a></li>
  </ul></li>
  <li><a href="#want-to-restart" id="toc-want-to-restart" class="nav-link" data-scroll-target="#want-to-restart">Want to Restart?</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/JeremyDemlow/LTBP/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Use Your CLI Commands</h1>
</div>

<div>
  <div class="description">
    This is how to do everything your gitlab pipeline will do locally using command line syntax
  </div>
</div>


<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="yaml-file-creations-base-query-for-feature-store-call" class="level2">
<h2 class="anchored" data-anchor-id="yaml-file-creations-base-query-for-feature-store-call">Yaml File Creations &amp; Base Query For Feature Store Call</h2>
<section id="create-base-feature-store-call" class="level3">
<h3 class="anchored" data-anchor-id="create-base-feature-store-call">Create Base Feature Store Call</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model has been going for a long time we only use 3 years of data but this is a legacy project being moved over</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>season_year<span class="op">=</span>[<span class="st">'2017/18'</span>, <span class="st">'2018/19'</span>, <span class="st">'2019/20'</span>, <span class="st">'2020/21'</span>, <span class="st">'2021/22'</span>]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing these to the season end years so that we don't get confused what year the data is for</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>seasons<span class="op">=</span>[<span class="st">'17_18'</span>, <span class="st">'18_19'</span>, <span class="st">'19_20'</span>, <span class="st">'20_21'</span>, <span class="st">'21_22'</span>]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> sy, s <span class="kw">in</span> <span class="bu">zip</span>(season_year, seasons):</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(Path(<span class="st">'./LTBP/files/sql_files/'</span>, <span class="ss">f'training_ecids_</span><span class="sc">{</span>s<span class="sc">}</span><span class="ss">.sql'</span>), <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="ss">f"""select</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="ss">distinct fs.ECID as ecid,</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ss">dd.SeasonYear as SeasonYear</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="ss">from BIDE_EDWDB_ARA_PROD.dbo.FactScan fs</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="ss">left join BIDE_EDWDB_ARA_PROD.dbo.DimDateSeason dd</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="ss">on dd.DateSeasonKey = fs.DateSeasonKey</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="ss">where</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="ss">dd.SeasonYear in ('</span><span class="sc">{</span>sy<span class="sc">}</span><span class="ss">')</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="ss">and fs.IsEmployee = 0</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="ss">and dd.Season = 'Winter'</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="ss">LIMIT 10000</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-features-yamldictionary" class="level3">
<h3 class="anchored" data-anchor-id="model-features-yamldictionary">Model Features Yaml/Dictionary</h3>
<p>This is described in depth inside of the Data_Preparation_Example.ipynb</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>feature_dict <span class="op">=</span> {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GenderCode'</span>:</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'STATIC'</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="va">None</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'GenderCode'</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span> ,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DESTINATIONGEOAFINITYLABEL'</span>:</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'STATIC'</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="va">None</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'DESTINATIONGEOAFINITYLABEL'</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Issue with temporal element eventual switch back</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># glv issue spotted and snowpark fixes it</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MarketingZone'</span>:</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'STATIC'</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="va">None</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'MarketingZone'</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Age'</span>:</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'Age_ECID_Temporal'</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cont'</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cont'</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'StandardScaler'</span>,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'StandardScaler'</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">'EverCorePass'</span>:</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'EverCorePass_ECID_Temporal'</span>,</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">'EverPass'</span>:</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'EverPass_ECID_Temporal'</span>,</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">'OnlySingleResortKey'</span>:</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'OnlySingleResortKey_ECID_Temporal'</span>,</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PartnerResortScannerFlag'</span>:</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'PartnerResortScannerFlag_ECID_Temporal'</span>,</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TotalSeasonsScanned'</span>:</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'TotalSeasonsScanned_ECID_Temporal'</span>,</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ResortsVisited'</span>:</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'ResortsVisited_ECID_Temporal'</span>,</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cont'</span>,</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cont'</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SubSeasonsPerYear'</span>:</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'SubSeasonsPerYear_ECID_Temporal'</span>,</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cont'</span>,</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cont'</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'StandardScaler'</span>,</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'StandardScaler'</span></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MostCommonTicketComp'</span>:</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'MostCommonTicketComp_ECID_Temporal'</span>,</span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AvgVisitPerSeason'</span>:</span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'AvgVisitPerSeason_ECID_Temporal'</span>,</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cont'</span>,</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cont'</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'StandardScaler'</span>,</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'StandardScaler'</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MostSubSeasonVisited'</span>:</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'MostSubSeasonVisited_ECID_Temporal'</span>,</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TotalVisits'</span>:</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'TotalVisits_ECID_Temporal'</span>,</span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cont'</span>,</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cont'</span></span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'StandardScaler'</span>,</span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'StandardScaler'</span></span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VisitMostInPeak'</span>:</span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'VisitMostInPeak_ECID_Temporal'</span>,</span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MostVisitedRegion'</span>:</span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'MostVisitedRegion_ECID_Temporal'</span>,</span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MostVisitedResort'</span>:</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'3_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'MostVisitedResort_ECID_Temporal'</span>,</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IsEpicMixActivated'</span>:</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'SEASONYEAR'</span>,</span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'IsEpicMixActivated_ECID_Temporal'</span>,</span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MarketingZone'</span>:</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'SEASONYEAR'</span>,</span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'MarketingZone_ECID_Temporal'</span>,</span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SkierabilityLabel'</span>:</span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'SEASONYEAR'</span>,</span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'SkierabilityLabel_ECID_Temporal'</span>,</span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GuestBehavior'</span>:</span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'SEASONYEAR'</span>,</span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'GuestBehavior_ECID_Temporal'</span>,</span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a>    <span class="st">'EverCorePass'</span>:</span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'ORIGIN_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-360"><a href="#cb2-360" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-361"><a href="#cb2-361" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'EverCorePass_ECID_Temporal'</span>,</span>
<span id="cb2-362"><a href="#cb2-362" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-363"><a href="#cb2-363" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-364"><a href="#cb2-364" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-365"><a href="#cb2-365" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-366"><a href="#cb2-366" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-367"><a href="#cb2-367" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-368"><a href="#cb2-368" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-369"><a href="#cb2-369" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-370"><a href="#cb2-370" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-371"><a href="#cb2-371" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-372"><a href="#cb2-372" aria-hidden="true" tabindex="-1"></a>    <span class="st">'EverPass'</span>:</span>
<span id="cb2-373"><a href="#cb2-373" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-374"><a href="#cb2-374" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-375"><a href="#cb2-375" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'ORIGIN_YEAR_DATE_RANGE'</span>,</span>
<span id="cb2-376"><a href="#cb2-376" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'FEATURE'</span>,</span>
<span id="cb2-377"><a href="#cb2-377" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'EverPass_ECID_Temporal'</span>,</span>
<span id="cb2-378"><a href="#cb2-378" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-379"><a href="#cb2-379" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-380"><a href="#cb2-380" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-381"><a href="#cb2-381" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-382"><a href="#cb2-382" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span>: {</span>
<span id="cb2-383"><a href="#cb2-383" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'OrdinalEncoder'</span>,</span>
<span id="cb2-384"><a href="#cb2-384" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'OrdinalEncoder'</span></span>
<span id="cb2-385"><a href="#cb2-385" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-386"><a href="#cb2-386" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-387"><a href="#cb2-387" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-388"><a href="#cb2-388" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BoughtPass'</span>: </span>
<span id="cb2-389"><a href="#cb2-389" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-390"><a href="#cb2-390" aria-hidden="true" tabindex="-1"></a>        <span class="st">'feature_type'</span>: <span class="st">'TEMP'</span>,</span>
<span id="cb2-391"><a href="#cb2-391" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_type'</span>: <span class="st">'SEASONYEAR'</span>,</span>
<span id="cb2-392"><a href="#cb2-392" aria-hidden="true" tabindex="-1"></a>        <span class="st">'input_definition'</span>: <span class="st">'LABEL'</span>,</span>
<span id="cb2-393"><a href="#cb2-393" aria-hidden="true" tabindex="-1"></a>        <span class="st">'udf_name'</span>: <span class="st">'BoughtPass_ECID_Temporal'</span>, </span>
<span id="cb2-394"><a href="#cb2-394" aria-hidden="true" tabindex="-1"></a>        <span class="st">'var_type'</span>: {</span>
<span id="cb2-395"><a href="#cb2-395" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="st">'cat'</span>,</span>
<span id="cb2-396"><a href="#cb2-396" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'cat'</span></span>
<span id="cb2-397"><a href="#cb2-397" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-398"><a href="#cb2-398" aria-hidden="true" tabindex="-1"></a>        <span class="st">'transformation'</span> : {</span>
<span id="cb2-399"><a href="#cb2-399" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span>: <span class="va">None</span>,</span>
<span id="cb2-400"><a href="#cb2-400" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span>: <span class="st">'None'</span></span>
<span id="cb2-401"><a href="#cb2-401" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-402"><a href="#cb2-402" aria-hidden="true" tabindex="-1"></a>        <span class="st">'experiment_list'</span>: [<span class="st">'BASELINE'</span>, <span class="st">'NOHYPEROPT'</span>]</span>
<span id="cb2-403"><a href="#cb2-403" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-404"><a href="#cb2-404" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-405"><a href="#cb2-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-406"><a href="#cb2-406" aria-hidden="true" tabindex="-1"></a>write_yaml_file(<span class="st">'./LTBP/files/yaml_files/'</span>, <span class="st">'features.yaml'</span>, feature_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="udf-inputs-yamldictionary" class="level3">
<h3 class="anchored" data-anchor-id="udf-inputs-yamldictionary">UDF Inputs Yaml/Dictionary</h3>
<p>This is described in depth inside of the Data_Preparation_Example.ipynb</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>udf_inputs <span class="op">=</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TRAINING'</span>: {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span><span class="al">TODO</span><span class="co">: PR to remove this duplication</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UDF_GRAIN'</span> : [<span class="st">'base.ECID'</span>], <span class="co"># input key to all udfs</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'FEATURE'</span>:{</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span> : {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'SEASON_END'</span>:{</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> : <span class="st">'20181005'</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> : <span class="st">'20191005'</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> : <span class="st">'20201005'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'3_YEAR_DATE_RANGE'</span>:{</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> : [<span class="st">'20171001'</span>, <span class="st">'20191005'</span>],</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> : [<span class="st">'20181001'</span>, <span class="st">'20201005'</span>],</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> : [<span class="st">'20191001'</span>, <span class="st">'20211005'</span>],</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SEASONYEAR'</span>:{</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2017/18</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2018/19</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2019/20</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ORIGIN_YEAR_DATE_RANGE'</span>:{</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> : [<span class="st">'20151005'</span>, <span class="st">'20191005'</span>],</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> : [<span class="st">'20151005'</span>, <span class="st">'20201005'</span>],</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> : [<span class="st">'20151005'</span>, <span class="st">'20211005'</span>],</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'NOHYPEROPT'</span> : {</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">'SEASON_END'</span>:{</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> : <span class="st">'20181005'</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> : <span class="st">'20191005'</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> : <span class="st">'20201005'</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">'3_YEAR_DATE_RANGE'</span>:{</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> : [<span class="st">'20171001'</span>, <span class="st">'20191005'</span>],</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> : [<span class="st">'20181001'</span>, <span class="st">'20201005'</span>],</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> : [<span class="st">'20191001'</span>, <span class="st">'20211005'</span>],</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SEASONYEAR'</span>:{</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2017/18</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2018/19</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2019/20</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ORIGIN_YEAR_DATE_RANGE'</span>:{</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> : [<span class="st">'20151005'</span>, <span class="st">'20191005'</span>],</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> : [<span class="st">'20151005'</span>, <span class="st">'20201005'</span>],</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> : [<span class="st">'20151005'</span>, <span class="st">'20211005'</span>],</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">'LABEL'</span> : {</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span> : {</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'SEASONYEAR'</span>: {</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2019/20</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2020/21</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2021/22</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span> : {</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'SEASONYEAR'</span>: {</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2019/20</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2020/21</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2021/22</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">'BASE_QUERY'</span>: {</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BASELINE'</span> : {</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span> : <span class="st">'training_ecids_18_19.sql'</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span> : <span class="st">'training_ecids_19_20.sql'</span>,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>                <span class="dv">2</span> : <span class="st">'training_ecids_20_21.sql'</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NOHYPEROPT'</span> : {</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span> : <span class="st">'training_ecids_18_19.sql'</span>,</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span> : <span class="st">'training_ecids_19_20.sql'</span>,</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>                <span class="dv">2</span> : <span class="st">'training_ecids_20_21.sql'</span>,</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ADDITIONAL_COLUMNS'</span>: {</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SEASONYEAR'</span>: {</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>: <span class="st">"'2018/19'"</span>,</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>: <span class="st">"'2019/20'"</span>,</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>                <span class="dv">2</span>: <span class="st">"'2020/21'"</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">'INFERENCE'</span>: {</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>     <span class="st">'UDF_GRAIN'</span> : [<span class="st">'base.ECID'</span>], <span class="co"># input key to all udfs</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>     <span class="st">'FEATURE'</span>:{</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>         <span class="st">'BASELINE'</span> : { </span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>             <span class="st">'SEASON_END'</span>: {    </span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">0</span> : <span class="st">'20221005'</span>,</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3_YEAR_DATE_RANGE'</span>: {</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">0</span> : [<span class="st">'20190101'</span>, <span class="st">'20221005'</span>],</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SEASONYEAR'</span>: {</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2021/22</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">'ORIGIN_YEAR_DATE_RANGE'</span>: { </span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> : [<span class="st">'20051001'</span>, <span class="st">'20221005'</span>],</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>        <span class="st">'NOHYPEROPT'</span> : { </span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>             <span class="st">'SEASON_END'</span>: {    </span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">0</span> : <span class="st">'20221005'</span>,</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3_YEAR_DATE_RANGE'</span>: {</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">0</span> : [<span class="st">'20190101'</span>, <span class="st">'20221005'</span>],</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SEASONYEAR'</span>: {</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2021/22</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>            <span class="st">'ORIGIN_YEAR_DATE_RANGE'</span>: { </span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span> : [<span class="st">'20051001'</span>, <span class="st">'20221005'</span>],</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>         },</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LABEL'</span> : {</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>        <span class="st">'BASELINE'</span> : {</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SEASONYEAR'</span> : {</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2021/22</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>        <span class="st">'NOHYPEROPT'</span> : {</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SEASONYEAR'</span> : {</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span> :  <span class="st">"</span><span class="ch">\'</span><span class="st">2021/22</span><span class="ch">\'</span><span class="st">"</span>,</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BASE_QUERY'</span>: {</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>        <span class="st">'BASELINE'</span> : {</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> : <span class="st">'inference_base.sql'</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>        <span class="st">'NOHYPEROPT'</span> : {</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> : <span class="st">'inference_base.sql'</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ADDITIONAL_COLUMNS'</span>: {</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>            <span class="st">'SEASONYEAR'</span>: {</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>: <span class="st">"'2021/22'"</span>,</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>write_yaml_file(<span class="st">'./LTBP/files/yaml_files/'</span>, <span class="st">'udf_inputs.yaml'</span>, udf_inputs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="etl-yamldictionary" class="level3">
<h3 class="anchored" data-anchor-id="etl-yamldictionary">ETL Yaml/Dictionary</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>etl <span class="op">=</span> <span class="bu">dict</span>({</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'azure_account'</span>: <span class="st">'vaildtscadls'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'azure_container'</span>: <span class="st">'vailadls'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'data_lake_path'</span>: <span class="st">'projects/LTBP/FY23/'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'max_file_size'</span>: <span class="st">'32000000'</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'over_write'</span>: <span class="st">'True'</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a> <span class="st">'query_file_path'</span>: <span class="st">'sql_files/'</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'stage_name'</span>: <span class="st">'ltbp'</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a> <span class="st">'FY_folder'</span> : <span class="st">'FY23'</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'extra_statement'</span> : {</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TRAINING'</span>: <span class="va">None</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'INFERENCE'</span>: <span class="va">None</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>write_yaml_file(<span class="st">'./LTBP/files/yaml_files/'</span>, <span class="st">'etl.yaml'</span>, etl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-yamldictionary" class="level3">
<h3 class="anchored" data-anchor-id="model-yamldictionary">Model Yaml/Dictionary</h3>
<p><strong>Global Use</strong></p>
<ul>
<li><p>preprocessors_adls_path</p>
<ul>
<li><p>value: ‘preprocessors/’</p></li>
<li><p>purpose: this is where in adls your preprocessors will be sent with an additional level using the experiment model_trainer (i.e.&nbsp;preprocessor/train_xgb/)</p></li>
</ul></li>
<li><p>modeling_adls_path</p>
<ul>
<li><p>value: ‘modeling/’</p></li>
<li><p>purpose: this is where in adls your models will be sent with an additional level using the experiment model_trainer (i.e.&nbsp;modeling/train_xgb/)</p></li>
</ul></li>
<li><p>predictions_adls_path</p>
<ul>
<li><p>value: ‘predictions/’</p></li>
<li><p>purpose: this is where in adls your model prediction file will be sent with an additional level using the experiment model_trainer (i.e.&nbsp;modeling/train_xgb/)</p></li>
</ul></li>
<li><p>connection_str</p>
<ul>
<li><p>value: ‘DATALAKE_CONN_STR_SECRET’</p></li>
<li><p>purpose: n/a</p></li>
</ul></li>
<li><p>sas_token</p>
<ul>
<li><p>value: ‘DATALAKE_SAS_TOKEN_SECRET’</p></li>
<li><p>purpose: n/a</p></li>
</ul></li>
<li><p>hold_out_table</p>
<ul>
<li><p>value: ‘LTBP_HOLDOUT_TEST_MODEL_RESULTS’</p></li>
<li><p>purpose: this example uses a test set, but if you don’t have one then the validation set will be sent to this location with the identification columns with your custom <code>send_holdout_results_to_sf</code></p></li>
</ul></li>
<li><p>tracking_table</p>
<ul>
<li><p>value: ‘LTBP_MODEL_TRACKING_FY23’</p></li>
<li><p>purpose: this is the name of the project log from msu will send your information for this run.</p></li>
</ul></li>
<li><p>identification</p>
<ul>
<li><p>value: [‘ECID’, ‘SEASONYEAR’]</p></li>
<li><p>purpose: these columns will make it to your hold out set as well as your inference table to help with identification to a correct lable.</p></li>
</ul></li>
<li><p>inference_sf_table_name</p>
<ul>
<li><p>value: ‘LTBP_PREDICTIONS_FY23’</p></li>
<li><p>purpose: the inference table name that will be created</p></li>
</ul></li>
</ul>
<p><strong>Inside Experiment</strong></p>
<p>As of right now to keep this going it expect that you have the hyper opt options there even if you don’t use it in your current model you can see that in this example they are set to None for things that aren’t relevant to your current model. This process will be improved upon as we iterate.</p>
<ul>
<li>model_trainer: is the function inside of models.py that is going to be used for inference</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>models_dict <span class="op">=</span> <span class="bu">dict</span>({</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'preprocessors_adls_path'</span> : <span class="st">'preprocessors/'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'modeling_adls_path'</span> : <span class="st">'modeling/'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'predictions_adls_path'</span>: <span class="st">'predictions/'</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'connection_str'</span>: <span class="st">'DATALAKE_CONN_STR_SECRET'</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sas_token'</span> : <span class="st">'DATALAKE_SAS_TOKEN_SECRET'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'hold_out_table'</span> : <span class="st">'LTBP_HOLDOUT_TEST_MODEL_RESULTS'</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'tracking_table'</span> : <span class="st">'LTBP_MODEL_TRACKING_FY23'</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'identification'</span>: [<span class="st">'ECID'</span>, <span class="st">'SEASONYEAR'</span>],</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'inference_sf_table_name'</span>: <span class="st">'LTBP_PREDICTIONS_FY23'</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BASELINE'</span>: {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'description'</span>: <span class="st">'Standard baseline xgb_hyperopt approach status quo of LTBP of the past'</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'model_trainer'</span>: <span class="st">'train_xgb'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'y_preprocess_object_name'</span>: <span class="va">None</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'y_scaler_type'</span> : <span class="va">None</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'x_preprocess_object_name'</span>: <span class="st">'standard_pipe.pickle'</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'hyperopt_evals'</span> : <span class="dv">2</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'hyper_opt_subsample_size'</span>: <span class="dv">2750000</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'training_subsample_size'</span> : <span class="dv">5000000</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NOHYPEROPT'</span>: {</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">'description'</span>: <span class="st">'Only here to see if it works delete at some point xgb_fit_only'</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">'model_trainer'</span>: <span class="st">'train_xgb_basic'</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">'y_preprocess_object_name'</span>: <span class="va">None</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'y_scaler_type'</span> : <span class="va">None</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'x_preprocess_object_name'</span>: <span class="st">'standard_pipe.pickle'</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'hyper_opt_subsample_size'</span> : <span class="st">''</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'hyperopt_evals'</span> : <span class="st">''</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'training_subsample_size'</span> : <span class="dv">5000000</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>write_yaml_file(<span class="st">'./LTBP/files/yaml_files/'</span>, <span class="st">'models.yaml'</span>, models_dict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="result" class="level3">
<h3 class="anchored" data-anchor-id="result">Result</h3>
<p>The project yamls files are created and sent to the location below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls .<span class="op">/</span>LTBP<span class="op">/</span>files<span class="op">/</span>yaml_files<span class="op">/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>etl.yaml        features.yaml   models.yaml     udf_inputs.yaml</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls .<span class="op">/</span>LTBP<span class="op">/</span>files<span class="op">/</span>sql_files<span class="op">/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>inference_base.sql       training_ecids_18_19.sql training_ecids_20_21.sql
training_ecids_17_18.sql training_ecids_19_20.sql training_ecids_21_22.sql</code></pre>
</div>
</div>
</section>
</section>
<section id="data-set-creation" class="level2">
<h2 class="anchored" data-anchor-id="data-set-creation">Data Set Creation</h2>
<p>Lets grab a training set for the <em>BASELINE</em> &amp; <em>NOHYPEROPT</em> experiment this is where you might want to build functionality to allow the project to only create a new data source if the data is different, but that was a little more work than what was taken on here, but very much a possibility</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> data_creation  <span class="op">--</span>train_or_inference <span class="st">"TRAINING"</span> <span class="op">--</span>experiment_name <span class="st">"BASELINE"</span> <span class="op">--</span>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:root:This is a experiment run
INFO:root:Loading Yaml Files..
INFO:root:Generating Feature Set Query
INFO:root:static features in data set: 
 ['DESTINATIONGEOAFINITYLABEL', 'GenderCode']
INFO:root:temporal features in data set: 
 ['Age', 'AvgVisitPerSeason', 'BoughtPass', 'EverCorePass', 'EverPass', 'GuestBehavior', 'IsEpicMixActivated', 'MarketingZone', 'MostCommonTicketComp', 'MostSubSeasonVisited', 'MostVisitedRegion', 'MostVisitedResort', 'OnlySingleResortKey', 'PartnerResortScannerFlag', 'ResortsVisited', 'SkierabilityLabel', 'SubSeasonsPerYear', 'TotalSeasonsScanned', 'TotalVisits', 'VisitMostInPeak']
INFO:root:Appending static feature DESTINATIONGEOAFINITYLABEL to query
INFO:root:Appending static feature GenderCode to query
INFO:root:Finished appending static features
INFO:root:reading training_ecids_18_19.sql for base query...
INFO:root:reading training_ecids_19_20.sql for base query...
INFO:root:reading training_ecids_20_21.sql for base query...
INFO:root:final query output: 
 select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20171001, 20191005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20171001, 20191005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2019/20') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20151005, 20191005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20151005, 20191005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2017/18') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2017/18') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2017/18') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20171001, 20191005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20171001, 20191005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20171001, 20191005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20171001, 20191005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20171001, 20191005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20171001, 20191005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20171001, 20191005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2017/18') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20171001, 20191005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20171001, 20191005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20171001, 20191005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20171001, 20191005) as VisitMostInPeak

, '2018/19' as SEASONYEAR
from
(select
distinct fs.ECID as ecid,
dd.SeasonYear as SeasonYear
from BIDE_EDWDB_ARA_PROD.dbo.FactScan fs
left join BIDE_EDWDB_ARA_PROD.dbo.DimDateSeason dd
on dd.DateSeasonKey = fs.DateSeasonKey
where
dd.SeasonYear in ('2018/19')
and fs.IsEmployee = 0
and dd.Season = 'Winter'
LIMIT 10000
)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid 
UNION ALL
select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20181001, 20201005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20181001, 20201005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2020/21') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20151005, 20201005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20151005, 20201005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2018/19') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2018/19') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2018/19') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20181001, 20201005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20181001, 20201005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20181001, 20201005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20181001, 20201005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20181001, 20201005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20181001, 20201005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20181001, 20201005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2018/19') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20181001, 20201005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20181001, 20201005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20181001, 20201005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20181001, 20201005) as VisitMostInPeak

, '2019/20' as SEASONYEAR
from
(select
distinct fs.ECID as ecid,
dd.SeasonYear as SeasonYear
from BIDE_EDWDB_ARA_PROD.dbo.FactScan fs
left join BIDE_EDWDB_ARA_PROD.dbo.DimDateSeason dd
on dd.DateSeasonKey = fs.DateSeasonKey
where
dd.SeasonYear in ('2019/20')
and fs.IsEmployee = 0
and dd.Season = 'Winter'
LIMIT 10000
)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid 
UNION ALL
select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20191001, 20211005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20191001, 20211005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2021/22') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20151005, 20211005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20151005, 20211005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2019/20') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2019/20') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2019/20') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20191001, 20211005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20191001, 20211005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20191001, 20211005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20191001, 20211005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20191001, 20211005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20191001, 20211005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20191001, 20211005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2019/20') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20191001, 20211005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20191001, 20211005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20191001, 20211005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20191001, 20211005) as VisitMostInPeak

, '2020/21' as SEASONYEAR
from
(select
distinct fs.ECID as ecid,
dd.SeasonYear as SeasonYear
from BIDE_EDWDB_ARA_PROD.dbo.FactScan fs
left join BIDE_EDWDB_ARA_PROD.dbo.DimDateSeason dd
on dd.DateSeasonKey = fs.DateSeasonKey
where
dd.SeasonYear in ('2020/21')
and fs.IsEmployee = 0
and dd.Season = 'Winter'
LIMIT 10000
)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid
INFO:root:Checking projects/LTBP/FY23/experiments/NOHYPEROPT/training_data/ to either skip creation for experiment or create a production dataset</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:data_system_utilities.azure.storage:number of files in container path recursively 0
INFO:data_system_utilities.snowflake.copyinto:
COPY INTO 'azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/experiments/NOHYPEROPT/training_data/'
FROM (select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20171001, 20191005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20171001, 20191005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2019/20') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20151005, 20191005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20151005, 20191005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2017/18') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2017/18') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2017/18') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20171001, 20191005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20171001, 20191005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20171001, 20191005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20171001, 20191005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20171001, 20191005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20171001, 20191005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20171001, 20191005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2017/18') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20171001, 20191005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20171001, 20191005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20171001, 20191005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20171001, 20191005) as VisitMostInPeak

, '2018/19' as SEASONYEAR
from
(select
distinct fs.ECID as ecid,
dd.SeasonYear as SeasonYear
from BIDE_EDWDB_ARA_PROD.dbo.FactScan fs
left join BIDE_EDWDB_ARA_PROD.dbo.DimDateSeason dd
on dd.DateSeasonKey = fs.DateSeasonKey
where
dd.SeasonYear in ('2018/19')
and fs.IsEmployee = 0
and dd.Season = 'Winter'
LIMIT 10000
)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid 
UNION ALL
select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20181001, 20201005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20181001, 20201005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2020/21') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20151005, 20201005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20151005, 20201005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2018/19') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2018/19') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2018/19') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20181001, 20201005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20181001, 20201005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20181001, 20201005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20181001, 20201005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20181001, 20201005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20181001, 20201005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20181001, 20201005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2018/19') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20181001, 20201005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20181001, 20201005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20181001, 20201005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20181001, 20201005) as VisitMostInPeak

, '2019/20' as SEASONYEAR
from
(select
distinct fs.ECID as ecid,
dd.SeasonYear as SeasonYear
from BIDE_EDWDB_ARA_PROD.dbo.FactScan fs
left join BIDE_EDWDB_ARA_PROD.dbo.DimDateSeason dd
on dd.DateSeasonKey = fs.DateSeasonKey
where
dd.SeasonYear in ('2019/20')
and fs.IsEmployee = 0
and dd.Season = 'Winter'
LIMIT 10000
)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid 
UNION ALL
select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20191001, 20211005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20191001, 20211005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2021/22') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20151005, 20211005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20151005, 20211005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2019/20') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2019/20') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2019/20') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20191001, 20211005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20191001, 20211005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20191001, 20211005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20191001, 20211005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20191001, 20211005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20191001, 20211005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20191001, 20211005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2019/20') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20191001, 20211005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20191001, 20211005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20191001, 20211005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20191001, 20211005) as VisitMostInPeak

, '2020/21' as SEASONYEAR
from
(select
distinct fs.ECID as ecid,
dd.SeasonYear as SeasonYear
from BIDE_EDWDB_ARA_PROD.dbo.FactScan fs
left join BIDE_EDWDB_ARA_PROD.dbo.DimDateSeason dd
on dd.DateSeasonKey = fs.DateSeasonKey
where
dd.SeasonYear in ('2020/21')
and fs.IsEmployee = 0
and dd.Season = 'Winter'
LIMIT 10000
)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid)

max_file_size = 3200000
overwrite = True
file_format = (type = parquet          )
credentials= (azure_sas_token = '**MASKED**')
header = True;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:data has been delivered from sf to adls</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> data_creation  <span class="op">--</span>train_or_inference <span class="st">"TRAINING"</span> <span class="op">--</span>experiment_name <span class="st">"NOHYPEROPT"</span> <span class="op">--</span>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lets now grab a <strong>inference/test set</strong> and place it into adls for the batch inference process</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> data_creation  <span class="op">--</span>train_or_inference <span class="st">'INFERENCE'</span> <span class="op">--</span>experiment_name <span class="st">'BASELINE'</span> <span class="op">--</span>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:root:This is a experiment run
INFO:root:Loading Yaml Files..
INFO:root:Generating Feature Set Query
INFO:root:static features in data set: 
 ['DESTINATIONGEOAFINITYLABEL', 'GenderCode']
INFO:root:temporal features in data set: 
 ['Age', 'AvgVisitPerSeason', 'BoughtPass', 'EverCorePass', 'EverPass', 'GuestBehavior', 'IsEpicMixActivated', 'MarketingZone', 'MostCommonTicketComp', 'MostSubSeasonVisited', 'MostVisitedRegion', 'MostVisitedResort', 'OnlySingleResortKey', 'PartnerResortScannerFlag', 'ResortsVisited', 'SkierabilityLabel', 'SubSeasonsPerYear', 'TotalSeasonsScanned', 'TotalVisits', 'VisitMostInPeak']
INFO:root:Appending static feature DESTINATIONGEOAFINITYLABEL to query
INFO:root:Appending static feature GenderCode to query
INFO:root:Finished appending static features
INFO:root:reading inference_base.sql for base query...
INFO:root:final query output: 
 select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20190101, 20221005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20190101, 20221005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2021/22') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2021/22') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2021/22') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2021/22') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20190101, 20221005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20190101, 20221005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20190101, 20221005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2021/22') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20190101, 20221005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20190101, 20221005) as VisitMostInPeak

, '2021/22' as SEASONYEAR
from
(-- base EDEE team guest behavior
  with edee_base as (
      SELECT 
            distinct ECID
      from BIDE_EDWDB_CUSTOMERMART_PROD.DBO.CustomerPASSPURCHASEBEHAVIOR cla
      where 
              cla.GuestPassPurchaseBehaviorDetailLabel &lt;&gt; 'Unknown'
  ),

  -- pass prospects not in guest behavior
  prospects as (
      Select
            distinct ECID
      from Vail_Reporting.Prod.GuestBehaviorBase
      where 
              GuestBehavior = 'Prospect'
          and salesseason = '2021/22'
  ),

  -- paid prospects not in guest behavior
  other_scans as (
      select
            distinct a.ECID
      from
      (
          select 
                distinct ECID
              , SeasonYear
          from "BIDE_EDWDB_ARA_PROD"."DBO"."SCANDAY"
              where Season = 'Winter'
      ) a
      left join Vail_Reporting.Prod.GuestBehaviorBase b 
          on a.ECID = b.ECID and a.SeasonYear = b.SalesSeason
      where 
              b.GuestBehavior is null
          and a.seasonyear = '2021/22'
  )

  select
        distinct ECID
      , 'Inference Set' as SeasonYear
  from
  (
      select
            coalesce(base.ecid, pro.ecid, os.ecid) as ecid
      from edee_base base
      full outer join prospects pro
          on pro.ecid = base.ecid
      full outer join other_scans os
          on os.ecid = base.ecid
  ) a)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid
INFO:root:Checking projects/LTBP/FY23/experiments/NOHYPEROPT/inference_data/ to either skip creation for experiment or create a production dataset
INFO:data_system_utilities.azure.storage:number of files in container path recursively 0
INFO:data_system_utilities.snowflake.copyinto:
COPY INTO 'azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/experiments/NOHYPEROPT/inference_data/'
FROM (select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20190101, 20221005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20190101, 20221005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2021/22') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2021/22') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2021/22') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2021/22') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20190101, 20221005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20190101, 20221005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20190101, 20221005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2021/22') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20190101, 20221005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20190101, 20221005) as VisitMostInPeak

, '2021/22' as SEASONYEAR
from
(-- base EDEE team guest behavior
  with edee_base as (
      SELECT 
            distinct ECID
      from BIDE_EDWDB_CUSTOMERMART_PROD.DBO.CustomerPASSPURCHASEBEHAVIOR cla
      where 
              cla.GuestPassPurchaseBehaviorDetailLabel &lt;&gt; 'Unknown'
  ),

  -- pass prospects not in guest behavior
  prospects as (
      Select
            distinct ECID
      from Vail_Reporting.Prod.GuestBehaviorBase
      where 
              GuestBehavior = 'Prospect'
          and salesseason = '2021/22'
  ),

  -- paid prospects not in guest behavior
  other_scans as (
      select
            distinct a.ECID
      from
      (
          select 
                distinct ECID
              , SeasonYear
          from "BIDE_EDWDB_ARA_PROD"."DBO"."SCANDAY"
              where Season = 'Winter'
      ) a
      left join Vail_Reporting.Prod.GuestBehaviorBase b 
          on a.ECID = b.ECID and a.SeasonYear = b.SalesSeason
      where 
              b.GuestBehavior is null
          and a.seasonyear = '2021/22'
  )

  select
        distinct ECID
      , 'Inference Set' as SeasonYear
  from
  (
      select
            coalesce(base.ecid, pro.ecid, os.ecid) as ecid
      from edee_base base
      full outer join prospects pro
          on pro.ecid = base.ecid
      full outer join other_scans os
          on os.ecid = base.ecid
  ) a)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid)

max_file_size = 3200000
overwrite = True
file_format = (type = parquet          )
credentials= (azure_sas_token = '**MASKED**')
header = True;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:data has been delivered from sf to adls</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> data_creation  <span class="op">--</span>train_or_inference <span class="st">'INFERENCE'</span> <span class="op">--</span>experiment_name <span class="st">'NOHYPEROPT'</span> <span class="op">--</span>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results</h3>
<p>Inside of the specified adls subscription described in the yaml files these first two steps create your data for your experiment or model run.</p>
<ul>
<li><p>projects/LTBP/FY23/experiments/BASELINE/training_data/</p></li>
<li><p>projects/LTBP/FY23/experiments/BASELINE/inference_data/</p></li>
</ul>
<blockquote class="blockquote">
<p>Note: experiments can be changed with CI_COMMIT_SHA depending on the methods approach that is being ran</p>
</blockquote>
</section>
</section>
<section id="train-model" class="level2">
<h2 class="anchored" data-anchor-id="train-model">Train Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> model_train <span class="op">--</span>experiment_name <span class="st">'BASELINE'</span> <span class="op">--</span>sfSchema <span class="st">'dev'</span> <span class="op">--</span>test_set <span class="op">--</span>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:data_system_utilities.snowflake.utils:stage_query: 
 create or replace stage ltbpFY23LocalRunTest
url='azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/experiments/BASELINE'
credentials=(azure_sas_token='**MASKED**')
encryption=(type= 'NONE')
file_format = (type = parquet        )
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Stage area LTBPFY23LOCALRUNTEST successfully created.
INFO:root:adls snowflake stage query 
    select
    $1:"ECID"::varchar as ECID
, $1:"SEASONYEAR"::varchar as SEASONYEAR
, $1:"AGE"::varchar as AGE
, $1:"AVGVISITPERSEASON"::varchar as AVGVISITPERSEASON
, $1:"BOUGHTPASS"::varchar as BOUGHTPASS
, $1:"DESTINATIONGEOAFINITYLABEL"::varchar as DESTINATIONGEOAFINITYLABEL
, $1:"EVERCOREPASS"::varchar as EVERCOREPASS
, $1:"EVERPASS"::varchar as EVERPASS
, $1:"GENDERCODE"::varchar as GENDERCODE
, $1:"GUESTBEHAVIOR"::varchar as GUESTBEHAVIOR
, $1:"ISEPICMIXACTIVATED"::varchar as ISEPICMIXACTIVATED
, $1:"MARKETINGZONE"::varchar as MARKETINGZONE
, $1:"MOSTCOMMONTICKETCOMP"::varchar as MOSTCOMMONTICKETCOMP
, $1:"MOSTSUBSEASONVISITED"::varchar as MOSTSUBSEASONVISITED
, $1:"MOSTVISITEDREGION"::varchar as MOSTVISITEDREGION
, $1:"MOSTVISITEDRESORT"::varchar as MOSTVISITEDRESORT
, $1:"ONLYSINGLERESORTKEY"::varchar as ONLYSINGLERESORTKEY
, $1:"PARTNERRESORTSCANNERFLAG"::varchar as PARTNERRESORTSCANNERFLAG
, $1:"RESORTSVISITED"::varchar as RESORTSVISITED
, $1:"SKIERABILITYLABEL"::varchar as SKIERABILITYLABEL
, $1:"SUBSEASONSPERYEAR"::varchar as SUBSEASONSPERYEAR
, $1:"TOTALSEASONSSCANNED"::varchar as TOTALSEASONSSCANNED
, $1:"TOTALVISITS"::varchar as TOTALVISITS
, $1:"VISITMOSTINPEAK"::varchar as VISITMOSTINPEAK

    from @ltbpFY23LocalRunTest/training_data/
    None
    
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:Preview dataframe queried        ECID SEASONYEAR AGE  ... TOTALSEASONSSCANNED TOTALVISITS VISITMOSTINPEAK
0  13586157    2018/19  60  ...                   2         101               0
1  53431921    2018/19  27  ...                   2          33               0
2  81037617    2018/19  23  ...                   1          16               1
3  84711794    2018/19  45  ...                   1           3               1
4  81962958    2018/19  24  ...                   1          25               0

[5 rows x 24 columns]
INFO:root:{'DESTINATIONGEOAFINITYLABEL': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'EVERCOREPASS': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'EVERPASS': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'GENDERCODE': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'GUESTBEHAVIOR': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'ISEPICMIXACTIVATED': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MARKETINGZONE': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MOSTCOMMONTICKETCOMP': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MOSTSUBSEASONVISITED': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MOSTVISITEDREGION': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MOSTVISITEDRESORT': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'ONLYSINGLERESORTKEY': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'PARTNERRESORTSCANNERFLAG': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'SKIERABILITYLABEL': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'TOTALSEASONSSCANNED': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'VISITMOSTINPEAK': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'AGE': {'transformation': {'name': 'StandardScaler', 'args': {}}, 'variable_type': 'cont'}, 'AVGVISITPERSEASON': {'transformation': {'name': 'StandardScaler', 'args': {}}, 'variable_type': 'cont'}, 'RESORTSVISITED': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'SUBSEASONSPERYEAR': {'transformation': {'name': 'StandardScaler', 'args': {}}, 'variable_type': 'cont'}, 'TOTALVISITS': {'transformation': {'name': 'StandardScaler', 'args': {}}, 'variable_type': 'cont'}}
INFO:root:categorical variables: 
 ['DESTINATIONGEOAFINITYLABEL', 'EVERCOREPASS', 'EVERPASS', 'GENDERCODE', 'GUESTBEHAVIOR', 'ISEPICMIXACTIVATED', 'MARKETINGZONE', 'MOSTCOMMONTICKETCOMP', 'MOSTSUBSEASONVISITED', 'MOSTVISITEDREGION', 'MOSTVISITEDRESORT', 'ONLYSINGLERESORTKEY', 'PARTNERRESORTSCANNERFLAG', 'SKIERABILITYLABEL', 'TOTALSEASONSSCANNED', 'VISITMOSTINPEAK']
INFO:root:continous variables: 
 ['AGE', 'AVGVISITPERSEASON', 'RESORTSVISITED', 'SUBSEASONSPERYEAR', 'TOTALVISITS']
INFO:machine_learning_utilities.preprocessing:Creating Sklearn Preprocessing Pipeline
INFO:machine_learning_utilities.preprocessing:Feature: DESTINATIONGEOAFINITYLABEL --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: EVERCOREPASS --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: EVERPASS --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: GENDERCODE --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: GUESTBEHAVIOR --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: ISEPICMIXACTIVATED --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MARKETINGZONE --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MOSTCOMMONTICKETCOMP --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MOSTSUBSEASONVISITED --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MOSTVISITEDREGION --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MOSTVISITEDRESORT --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: ONLYSINGLERESORTKEY --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: PARTNERRESORTSCANNERFLAG --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: SKIERABILITYLABEL --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: TOTALSEASONSSCANNED --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: VISITMOSTINPEAK --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: AGE --&gt; Transformer: StandardScaler()
INFO:machine_learning_utilities.preprocessing:Feature: AVGVISITPERSEASON --&gt; Transformer: StandardScaler()
INFO:machine_learning_utilities.preprocessing:Feature: RESORTSVISITED --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: SUBSEASONSPERYEAR --&gt; Transformer: StandardScaler()
INFO:machine_learning_utilities.preprocessing:Feature: TOTALVISITS --&gt; Transformer: StandardScaler()
INFO:machine_learning_utilities.preprocessing:Imputing missing data with mean strategy</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:machine_learning_utilities.preprocessing:Preprocessing Pipeline Object:
Pipeline(steps=[('preprocessing',
                 FeatureUnion(transformer_list=[('pipeline-1',
                                                 Pipeline(steps=[('functiontransformer',
                                                                  FunctionTransformer(func=&lt;function get_cat_cols&gt;,
                                                                                      kw_args={'cols': ['DESTINATIONGEOAFINITYLABEL']})),
                                                                 ('ordinalencoder',
                                                                  OrdinalEncoder(handle_unknown='use_encoded_value',
                                                                                 unknown_value=-1))])),
                                                ('pipeline-2',
                                                 Pipeline(steps=[('...
                                                                  FunctionTransformer(func=&lt;function get_cont_cols&gt;,
                                                                                      kw_args={'cols': ['SUBSEASONSPERYEAR']})),
                                                                 ('standardscaler',
                                                                  StandardScaler())])),
                                                ('pipeline-21',
                                                 Pipeline(steps=[('functiontransformer',
                                                                  FunctionTransformer(func=&lt;function get_cont_cols&gt;,
                                                                                      kw_args={'cols': ['TOTALVISITS']})),
                                                                 ('standardscaler',
                                                                  StandardScaler())]))])),
                ('imputing', SimpleImputer())])
INFO:root:Successfully Spilt Data
Train: (24000, 24), (24000, 1)
Valid: (5100, 24), (5100, 1)
Test: (900, 24), (900, 1)
INFO:root:Size of the id_list for the hold set (900, 2)
INFO:root:This project relies on the query to have accurate labels with no preprocessing..
INFO:root:Pushing Sklearn Object to Azure: projects/LTBP/FY23/experiments/BASELINE/preprocessors/train_xgb/LocalRunTeststandard_pipe.pickle
INFO:data_system_utilities.azure.storage:Uploading LocalRunTeststandard_pipe.pickle, to Azure Storage projects/LTBP/FY23/experiments/BASELINE/preprocessors/train_xgb/LocalRunTeststandard_pipe.pickle
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:root:LocalRunTeststandard_pipe.pickle successfully pushed to projects/LTBP/FY23/experiments/BASELINE/preprocessors/train_xgb
INFO:root:Hyper tuning on 24000 rows
  0%|                                     | 0/2 [00:00&lt;?, ?trial/s, best loss=?]INFO:hyperopt.tpe:build_posterior_wrapper took 0.008785 seconds
INFO:hyperopt.tpe:TPE using 0 trials
 50%|█████     | 1/2 [00:04&lt;00:04,  4.29s/trial, best loss: 0.10091012817111322]INFO:hyperopt.tpe:build_posterior_wrapper took 0.007306 seconds
INFO:hyperopt.tpe:TPE using 1/1 trials with best loss 0.100910
100%|███████████| 2/2 [00:05&lt;00:00,  2.85s/trial, best loss: 0.0966514288669098]
INFO:root:Full training on 24000 rows
INFO:root:Training Set Evaluation
INFO:root:Variable(s) of interest ['BOUGHTPASS'] AUC: 0.902    Accuracy: 0.827    Balanced Accuracy: 0.828
INFO:root:Feature Importance df: 
                           COLS     IMP
0                     EVERPASS  0.2268
1         MOSTCOMMONTICKETCOMP  0.0176
2            SUBSEASONSPERYEAR  0.0128
3   DESTINATIONGEOAFINITYLABEL  0.0074
4                GUESTBEHAVIOR  0.0042
5                          AGE  0.0034
6           ISEPICMIXACTIVATED  0.0028
7          TOTALSEASONSSCANNED  0.0022
8                 EVERCOREPASS  0.0006
9          ONLYSINGLERESORTKEY  0.0006
10                  GENDERCODE  0.0000
11               MARKETINGZONE  0.0000
12    PARTNERRESORTSCANNERFLAG  0.0000
13             VISITMOSTINPEAK  0.0000
14              RESORTSVISITED -0.0002
15        MOSTSUBSEASONVISITED -0.0004
16           MOSTVISITEDRESORT -0.0006
17           MOSTVISITEDREGION -0.0006
18           AVGVISITPERSEASON -0.0008
19                 TOTALVISITS -0.0008
20           SKIERABILITYLABEL -0.0016
INFO:root:Validation Set Evaluation
INFO:root:Variable(s) of interest ['BOUGHTPASS'] AUC: 0.902    Accuracy: 0.834    Balanced Accuracy: 0.835
INFO:root:Feature Importance df: 
                           COLS     IMP
0                     EVERPASS  0.2218
1         MOSTCOMMONTICKETCOMP  0.0166
2            SUBSEASONSPERYEAR  0.0122
3                GUESTBEHAVIOR  0.0080
4                 EVERCOREPASS  0.0060
5   DESTINATIONGEOAFINITYLABEL  0.0054
6           ISEPICMIXACTIVATED  0.0044
7                          AGE  0.0034
8          TOTALSEASONSSCANNED  0.0022
9            MOSTVISITEDREGION  0.0020
10              RESORTSVISITED  0.0014
11           SKIERABILITYLABEL  0.0012
12               MARKETINGZONE  0.0008
13                  GENDERCODE  0.0004
14         ONLYSINGLERESORTKEY  0.0004
15                 TOTALVISITS  0.0000
16    PARTNERRESORTSCANNERFLAG -0.0002
17        MOSTSUBSEASONVISITED -0.0002
18           AVGVISITPERSEASON -0.0006
19             VISITMOSTINPEAK -0.0012
20           MOSTVISITEDRESORT -0.0022
INFO:root:Test Set Evaluation
INFO:root:Variable(s) of interest ['BOUGHTPASS'] AUC: 0.888    Accuracy: 0.820    Balanced Accuracy: 0.823
INFO:root:Feature Importance df: 
                           COLS       IMP
0                     EVERPASS  0.210000
1         MOSTCOMMONTICKETCOMP  0.024444
2            SUBSEASONSPERYEAR  0.016667
3                 EVERCOREPASS  0.006667
4            MOSTVISITEDREGION  0.004444
5   DESTINATIONGEOAFINITYLABEL  0.003333
6                GUESTBEHAVIOR  0.002222
7              VISITMOSTINPEAK  0.002222
8               RESORTSVISITED  0.001111
9          ONLYSINGLERESORTKEY  0.001111
10           MOSTVISITEDRESORT  0.001111
11    PARTNERRESORTSCANNERFLAG  0.000000
12               MARKETINGZONE  0.000000
13          ISEPICMIXACTIVATED  0.000000
14                  GENDERCODE  0.000000
15                 TOTALVISITS  0.000000
16        MOSTSUBSEASONVISITED -0.001111
17         TOTALSEASONSSCANNED -0.001111
18           AVGVISITPERSEASON -0.001111
19                         AGE -0.003333
20           SKIERABILITYLABEL -0.004444
INFO:root:hold out data preview going to snowflake            ECID SEASONYEAR  ...          DATECREATED      EXP_COMMIT_CI_SHA
14448  28239825    2018/19  ...  2022-11-03 17:53:54  BASELINE_LocalRunTest
12515  20142908    2018/19  ...  2022-11-03 17:53:54  BASELINE_LocalRunTest
2167   12118124    2018/19  ...  2022-11-03 17:53:54  BASELINE_LocalRunTest

[3 rows x 5 columns]
INFO:data_system_utilities.snowflake.query:creating table LTBP_HOLDOUT_TEST_MODEL_RESULTS
INFO:data_system_utilities.snowflake.query:sqlalchemy snowflake engine created
INFO:data_system_utilities.snowflake.query:table created
INFO:root:saving test prediction file
INFO:root:sending prediction file to azure to projects/LTBP/FY23/experiments/BASELINE/holdout_results/train_xgb/
INFO:data_system_utilities.azure.storage:Uploading holdout_BASELINELocalRunTest.csv, to Azure Storage projects/LTBP/FY23/experiments/BASELINE/holdout_results/train_xgb/holdout_BASELINELocalRunTest.csv
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:data_system_utilities.snowflake.query:creating table LTBP_MODEL_TRACKING_FY23
INFO:data_system_utilities.snowflake.query:sqlalchemy snowflake engine created
INFO:data_system_utilities.snowflake.query:table created
INFO:root:project log preview:
                                  ACTION_DESCRIPTION  ... EVER_PRODUCTION
0  Standard baseline xgb_hyperopt approach status...  ...           False

[1 rows x 12 columns]
INFO:root:project log values preview:
['Standard baseline xgb_hyperopt approach status quo of LTBP of the past'
 'model_training' 'LocalRunTest' 'dev' 'random' '2022-11-03 17:53:58'
 '{"azure_parent_folder": "projects/LTBP/FY23/experiments/BASELINE"}'
 '{"training_metrics": {"auc": 0.9016874514791674, "acc": 0.826875, "bacc": 0.8283302060530875}, "fi_train": {"EVERPASS": 0.2268, "MOSTCOMMONTICKETCOMP": 0.01759999999999995, "SUBSEASONSPERYEAR": 0.012800000000000034, "DESTINATIONGEOAFINITYLABEL": 0.007399999999999962, "GUESTBEHAVIOR": 0.0041999999999999815, "AGE": 0.0033999999999999586, "ISEPICMIXACTIVATED": 0.0028000000000000247, "TOTALSEASONSSCANNED": 0.0021999999999999797, "EVERCOREPASS": 0.0005999999999999339, "ONLYSINGLERESORTKEY": 0.0005999999999999339}, "valid_metrics": {"auc": 0.9018520051783074, "acc": 0.8337254901960784, "bacc": 0.8351978400326507}, "fi_valid": {"EVERPASS": 0.2218, "MOSTCOMMONTICKETCOMP": 0.01660000000000006, "SUBSEASONSPERYEAR": 0.012199999999999989, "GUESTBEHAVIOR": 0.008000000000000007, "EVERCOREPASS": 0.006000000000000005, "DESTINATIONGEOAFINITYLABEL": 0.005400000000000071, "ISEPICMIXACTIVATED": 0.0044000000000000705, "AGE": 0.0034000000000000696, "TOTALSEASONSSCANNED": 0.0021999999999999797, "MOSTVISITEDREGION": 0.0020000000000000018}, "test_metrics": {"auc": 0.8879931109230473, "acc": 0.82, "bacc": 0.8226211156147463}, "fi_test": {"EVERPASS": 0.20999999999999996, "MOSTCOMMONTICKETCOMP": 0.02444444444444438, "SUBSEASONSPERYEAR": 0.016666666666666607, "EVERCOREPASS": 0.006666666666666599, "MOSTVISITEDREGION": 0.004444444444444362, "DESTINATIONGEOAFINITYLABEL": 0.0033333333333332993, "GUESTBEHAVIOR": 0.0022222222222221255, "VISITMOSTINPEAK": 0.0022222222222221255, "RESORTSVISITED": 0.0011111111111110628, "ONLYSINGLERESORTKEY": 0.0011111111111110628}}'
 'BASELINE' True False False]
INFO:root:Saving model and sending it to adls
INFO:root:Pushing Sklearn Object to Azure: projects/LTBP/FY23/experiments/BASELINE/modeling/train_xgb/train_xgbLocalRunTestBASELINE.pkl
INFO:data_system_utilities.azure.storage:Uploading train_xgbLocalRunTestBASELINE.pkl, to Azure Storage projects/LTBP/FY23/experiments/BASELINE/modeling/train_xgb/train_xgbLocalRunTestBASELINE.pkl</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:root:train_xgbLocalRunTestBASELINE.pkl successfully pushed to projects/LTBP/FY23/experiments/BASELINE/modeling/train_xgb</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> model_train <span class="op">--</span>experiment_name <span class="st">'NOHYPEROPT'</span> <span class="op">--</span>sfSchema <span class="st">'dev'</span> <span class="op">--</span>test_set <span class="op">--</span>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:data_system_utilities.snowflake.utils:stage_query: 
 create or replace stage ltbpFY23LocalRunTest
url='azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/experiments/NOHYPEROPT'
credentials=(azure_sas_token='**MASKED**')
encryption=(type= 'NONE')
file_format = (type = parquet        )
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Stage area LTBPFY23LOCALRUNTEST successfully created.
INFO:root:adls snowflake stage query 
    select
    $1:"ECID"::varchar as ECID
, $1:"SEASONYEAR"::varchar as SEASONYEAR
, $1:"AGE"::varchar as AGE
, $1:"AVGVISITPERSEASON"::varchar as AVGVISITPERSEASON
, $1:"BOUGHTPASS"::varchar as BOUGHTPASS
, $1:"DESTINATIONGEOAFINITYLABEL"::varchar as DESTINATIONGEOAFINITYLABEL
, $1:"EVERCOREPASS"::varchar as EVERCOREPASS
, $1:"EVERPASS"::varchar as EVERPASS
, $1:"GENDERCODE"::varchar as GENDERCODE
, $1:"GUESTBEHAVIOR"::varchar as GUESTBEHAVIOR
, $1:"ISEPICMIXACTIVATED"::varchar as ISEPICMIXACTIVATED
, $1:"MARKETINGZONE"::varchar as MARKETINGZONE
, $1:"MOSTCOMMONTICKETCOMP"::varchar as MOSTCOMMONTICKETCOMP
, $1:"MOSTSUBSEASONVISITED"::varchar as MOSTSUBSEASONVISITED
, $1:"MOSTVISITEDREGION"::varchar as MOSTVISITEDREGION
, $1:"MOSTVISITEDRESORT"::varchar as MOSTVISITEDRESORT
, $1:"ONLYSINGLERESORTKEY"::varchar as ONLYSINGLERESORTKEY
, $1:"PARTNERRESORTSCANNERFLAG"::varchar as PARTNERRESORTSCANNERFLAG
, $1:"RESORTSVISITED"::varchar as RESORTSVISITED
, $1:"SKIERABILITYLABEL"::varchar as SKIERABILITYLABEL
, $1:"SUBSEASONSPERYEAR"::varchar as SUBSEASONSPERYEAR
, $1:"TOTALSEASONSSCANNED"::varchar as TOTALSEASONSSCANNED
, $1:"TOTALVISITS"::varchar as TOTALVISITS
, $1:"VISITMOSTINPEAK"::varchar as VISITMOSTINPEAK

    from @ltbpFY23LocalRunTest/training_data/
    None
    
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:Preview dataframe queried        ECID SEASONYEAR AGE  ... TOTALSEASONSSCANNED TOTALVISITS VISITMOSTINPEAK
0  84750106    2018/19  17  ...                   1           4               0
1  22890858    2018/19  11  ...                   2          36               1
2  11086706    2018/19  51  ...                   2          26               0
3  41200213    2018/19  33  ...                   2           6               1
4  63937342    2018/19  63  ...                   2          34               1

[5 rows x 24 columns]
INFO:root:{'DESTINATIONGEOAFINITYLABEL': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'EVERCOREPASS': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'EVERPASS': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'GENDERCODE': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'GUESTBEHAVIOR': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'ISEPICMIXACTIVATED': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MARKETINGZONE': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MOSTCOMMONTICKETCOMP': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MOSTSUBSEASONVISITED': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MOSTVISITEDREGION': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'MOSTVISITEDRESORT': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'ONLYSINGLERESORTKEY': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'PARTNERRESORTSCANNERFLAG': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'SKIERABILITYLABEL': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'TOTALSEASONSSCANNED': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'VISITMOSTINPEAK': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'AGE': {'transformation': {'name': 'StandardScaler', 'args': {}}, 'variable_type': 'cont'}, 'AVGVISITPERSEASON': {'transformation': {'name': 'StandardScaler', 'args': {}}, 'variable_type': 'cont'}, 'RESORTSVISITED': {'transformation': {'name': 'OrdinalEncoder', 'args': {'handle_unknown': 'use_encoded_value', 'unknown_value': -1}}, 'variable_type': 'cat'}, 'SUBSEASONSPERYEAR': {'transformation': {'name': 'StandardScaler', 'args': {}}, 'variable_type': 'cont'}, 'TOTALVISITS': {'transformation': {'name': 'StandardScaler', 'args': {}}, 'variable_type': 'cont'}}
INFO:root:categorical variables: 
 ['DESTINATIONGEOAFINITYLABEL', 'EVERCOREPASS', 'EVERPASS', 'GENDERCODE', 'GUESTBEHAVIOR', 'ISEPICMIXACTIVATED', 'MARKETINGZONE', 'MOSTCOMMONTICKETCOMP', 'MOSTSUBSEASONVISITED', 'MOSTVISITEDREGION', 'MOSTVISITEDRESORT', 'ONLYSINGLERESORTKEY', 'PARTNERRESORTSCANNERFLAG', 'SKIERABILITYLABEL', 'TOTALSEASONSSCANNED', 'VISITMOSTINPEAK']
INFO:root:continous variables: 
 ['AGE', 'AVGVISITPERSEASON', 'RESORTSVISITED', 'SUBSEASONSPERYEAR', 'TOTALVISITS']
INFO:machine_learning_utilities.preprocessing:Creating Sklearn Preprocessing Pipeline
INFO:machine_learning_utilities.preprocessing:Feature: DESTINATIONGEOAFINITYLABEL --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: EVERCOREPASS --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: EVERPASS --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: GENDERCODE --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: GUESTBEHAVIOR --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: ISEPICMIXACTIVATED --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MARKETINGZONE --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MOSTCOMMONTICKETCOMP --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MOSTSUBSEASONVISITED --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MOSTVISITEDREGION --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: MOSTVISITEDRESORT --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: ONLYSINGLERESORTKEY --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: PARTNERRESORTSCANNERFLAG --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: SKIERABILITYLABEL --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: TOTALSEASONSSCANNED --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: VISITMOSTINPEAK --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: AGE --&gt; Transformer: StandardScaler()
INFO:machine_learning_utilities.preprocessing:Feature: AVGVISITPERSEASON --&gt; Transformer: StandardScaler()
INFO:machine_learning_utilities.preprocessing:Feature: RESORTSVISITED --&gt; Transformer: OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1)
INFO:machine_learning_utilities.preprocessing:Feature: SUBSEASONSPERYEAR --&gt; Transformer: StandardScaler()
INFO:machine_learning_utilities.preprocessing:Feature: TOTALVISITS --&gt; Transformer: StandardScaler()
INFO:machine_learning_utilities.preprocessing:Imputing missing data with mean strategy</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:machine_learning_utilities.preprocessing:Preprocessing Pipeline Object:
Pipeline(steps=[('preprocessing',
                 FeatureUnion(transformer_list=[('pipeline-1',
                                                 Pipeline(steps=[('functiontransformer',
                                                                  FunctionTransformer(func=&lt;function get_cat_cols&gt;,
                                                                                      kw_args={'cols': ['DESTINATIONGEOAFINITYLABEL']})),
                                                                 ('ordinalencoder',
                                                                  OrdinalEncoder(handle_unknown='use_encoded_value',
                                                                                 unknown_value=-1))])),
                                                ('pipeline-2',
                                                 Pipeline(steps=[('...
                                                                  FunctionTransformer(func=&lt;function get_cont_cols&gt;,
                                                                                      kw_args={'cols': ['SUBSEASONSPERYEAR']})),
                                                                 ('standardscaler',
                                                                  StandardScaler())])),
                                                ('pipeline-21',
                                                 Pipeline(steps=[('functiontransformer',
                                                                  FunctionTransformer(func=&lt;function get_cont_cols&gt;,
                                                                                      kw_args={'cols': ['TOTALVISITS']})),
                                                                 ('standardscaler',
                                                                  StandardScaler())]))])),
                ('imputing', SimpleImputer())])
INFO:root:Successfully Spilt Data
Train: (24000, 24), (24000, 1)
Valid: (5100, 24), (5100, 1)
Test: (900, 24), (900, 1)
INFO:root:Size of the id_list for the hold set (900, 2)
INFO:root:This project relies on the query to have accurate labels with no preprocessing..
INFO:root:Pushing Sklearn Object to Azure: projects/LTBP/FY23/experiments/NOHYPEROPT/preprocessors/train_xgb_basic/LocalRunTeststandard_pipe.pickle
INFO:data_system_utilities.azure.storage:Uploading LocalRunTeststandard_pipe.pickle, to Azure Storage projects/LTBP/FY23/experiments/NOHYPEROPT/preprocessors/train_xgb_basic/LocalRunTeststandard_pipe.pickle
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:root:LocalRunTeststandard_pipe.pickle successfully pushed to projects/LTBP/FY23/experiments/NOHYPEROPT/preprocessors/train_xgb_basic
INFO:LTBP.modeling.models:Training on 24000 rows
[0] validation_0-logloss:0.57143
[1] validation_0-logloss:0.50628
[2] validation_0-logloss:0.46755
[3] validation_0-logloss:0.44437
[4] validation_0-logloss:0.42945
[5] validation_0-logloss:0.41972
[6] validation_0-logloss:0.41147
[7] validation_0-logloss:0.40669
[8] validation_0-logloss:0.40339
[9] validation_0-logloss:0.40173
[10]    validation_0-logloss:0.40095
[11]    validation_0-logloss:0.40031
[12]    validation_0-logloss:0.39880
[13]    validation_0-logloss:0.39776
[14]    validation_0-logloss:0.39795
[15]    validation_0-logloss:0.39772
[16]    validation_0-logloss:0.39648
[17]    validation_0-logloss:0.39631
[18]    validation_0-logloss:0.39615
[19]    validation_0-logloss:0.39548
[20]    validation_0-logloss:0.39534
[21]    validation_0-logloss:0.39518
[22]    validation_0-logloss:0.39495
[23]    validation_0-logloss:0.39488
[24]    validation_0-logloss:0.39550
[25]    validation_0-logloss:0.39563
[26]    validation_0-logloss:0.39566
[27]    validation_0-logloss:0.39548
[28]    validation_0-logloss:0.39547
[29]    validation_0-logloss:0.39528
[30]    validation_0-logloss:0.39573
[31]    validation_0-logloss:0.39531
[32]    validation_0-logloss:0.39533
INFO:root:Training Set Evaluation
INFO:root:Variable(s) of interest ['BOUGHTPASS'] AUC: 0.923    Accuracy: 0.846    Balanced Accuracy: 0.847
INFO:root:Feature Importance df: 
                           COLS     IMP
0                     EVERPASS  0.2758
1         MOSTCOMMONTICKETCOMP  0.0352
2            SUBSEASONSPERYEAR  0.0208
3                  TOTALVISITS  0.0146
4                GUESTBEHAVIOR  0.0144
5                          AGE  0.0130
6   DESTINATIONGEOAFINITYLABEL  0.0100
7           ISEPICMIXACTIVATED  0.0068
8            AVGVISITPERSEASON  0.0064
9         MOSTSUBSEASONVISITED  0.0054
10           MOSTVISITEDRESORT  0.0054
11         TOTALSEASONSSCANNED  0.0052
12           MOSTVISITEDREGION  0.0046
13                EVERCOREPASS  0.0036
14              RESORTSVISITED  0.0030
15               MARKETINGZONE  0.0022
16         ONLYSINGLERESORTKEY  0.0012
17           SKIERABILITYLABEL  0.0010
18             VISITMOSTINPEAK  0.0006
19    PARTNERRESORTSCANNERFLAG  0.0000
20                  GENDERCODE  0.0000
INFO:root:Validation Set Evaluation
INFO:root:Variable(s) of interest ['BOUGHTPASS'] AUC: 0.900    Accuracy: 0.828    Balanced Accuracy: 0.829
INFO:root:Feature Importance df: 
                           COLS     IMP
0                     EVERPASS  0.2776
1         MOSTCOMMONTICKETCOMP  0.0326
2            SUBSEASONSPERYEAR  0.0126
3                GUESTBEHAVIOR  0.0088
4                  TOTALVISITS  0.0076
5                          AGE  0.0072
6   DESTINATIONGEOAFINITYLABEL  0.0070
7           ISEPICMIXACTIVATED  0.0054
8               RESORTSVISITED  0.0046
9            MOSTVISITEDREGION  0.0042
10           AVGVISITPERSEASON  0.0032
11                EVERCOREPASS  0.0030
12         ONLYSINGLERESORTKEY  0.0030
13           MOSTVISITEDRESORT  0.0022
14         TOTALSEASONSSCANNED  0.0020
15        MOSTSUBSEASONVISITED  0.0014
16           SKIERABILITYLABEL  0.0014
17    PARTNERRESORTSCANNERFLAG  0.0006
18               MARKETINGZONE  0.0000
19             VISITMOSTINPEAK  0.0000
20                  GENDERCODE -0.0010
INFO:root:Test Set Evaluation
INFO:root:Variable(s) of interest ['BOUGHTPASS'] AUC: 0.896    Accuracy: 0.829    Balanced Accuracy: 0.829
INFO:root:Feature Importance df: 
                           COLS       IMP
0                     EVERPASS  0.257778
1         MOSTCOMMONTICKETCOMP  0.028889
2            SUBSEASONSPERYEAR  0.024444
3                  TOTALVISITS  0.015556
4                GUESTBEHAVIOR  0.012222
5          TOTALSEASONSSCANNED  0.008889
6   DESTINATIONGEOAFINITYLABEL  0.005556
7            MOSTVISITEDRESORT  0.003333
8                 EVERCOREPASS  0.002222
9                MARKETINGZONE  0.001111
10                         AGE  0.001111
11         ONLYSINGLERESORTKEY  0.000000
12    PARTNERRESORTSCANNERFLAG  0.000000
13           SKIERABILITYLABEL  0.000000
14              RESORTSVISITED  0.000000
15                  GENDERCODE -0.001111
16           MOSTVISITEDREGION -0.002222
17             VISITMOSTINPEAK -0.002222
18        MOSTSUBSEASONVISITED -0.003333
19           AVGVISITPERSEASON -0.003333
20          ISEPICMIXACTIVATED -0.004444
INFO:root:hold out data preview going to snowflake            ECID SEASONYEAR  ...          DATECREATED        EXP_COMMIT_CI_SHA
14448  66980607    2019/20  ...  2022-11-03 17:54:12  NOHYPEROPT_LocalRunTest
12515  87007753    2018/19  ...  2022-11-03 17:54:12  NOHYPEROPT_LocalRunTest
2167   84798822    2018/19  ...  2022-11-03 17:54:12  NOHYPEROPT_LocalRunTest

[3 rows x 5 columns]
INFO:data_system_utilities.snowflake.query:creating table LTBP_HOLDOUT_TEST_MODEL_RESULTS
INFO:data_system_utilities.snowflake.query:sqlalchemy snowflake engine created
INFO:data_system_utilities.snowflake.query:table created
INFO:root:saving test prediction file
INFO:root:sending prediction file to azure to projects/LTBP/FY23/experiments/NOHYPEROPT/holdout_results/train_xgb_basic/
INFO:data_system_utilities.azure.storage:Uploading holdout_NOHYPEROPTLocalRunTest.csv, to Azure Storage projects/LTBP/FY23/experiments/NOHYPEROPT/holdout_results/train_xgb_basic/holdout_NOHYPEROPTLocalRunTest.csv
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:data_system_utilities.snowflake.query:creating table LTBP_MODEL_TRACKING_FY23
INFO:data_system_utilities.snowflake.query:sqlalchemy snowflake engine created</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:data_system_utilities.snowflake.query:table created
INFO:root:project log preview:
                                  ACTION_DESCRIPTION  ... EVER_PRODUCTION
0  Only here to see if it works delete at some po...  ...           False

[1 rows x 12 columns]
INFO:root:project log values preview:
['Only here to see if it works delete at some point xgb_fit_only'
 'model_training' 'LocalRunTest' 'dev' 'random' '2022-11-03 17:54:17'
 '{"azure_parent_folder": "projects/LTBP/FY23/experiments/NOHYPEROPT"}'
 '{"training_metrics": {"auc": 0.9233503051910592, "acc": 0.8459166666666667, "bacc": 0.8470889725812882}, "fi_train": {"EVERPASS": 0.27579999999999993, "MOSTCOMMONTICKETCOMP": 0.03520000000000001, "SUBSEASONSPERYEAR": 0.02079999999999993, "TOTALVISITS": 0.014599999999999946, "GUESTBEHAVIOR": 0.014399999999999968, "AGE": 0.0129999999999999, "DESTINATIONGEOAFINITYLABEL": 0.010000000000000009, "ISEPICMIXACTIVATED": 0.006799999999999917, "AVGVISITPERSEASON": 0.006399999999999961, "MOSTSUBSEASONVISITED": 0.00539999999999996}, "valid_metrics": {"auc": 0.9001165901790553, "acc": 0.827843137254902, "bacc": 0.8294653892340191}, "fi_valid": {"EVERPASS": 0.27760000000000007, "MOSTCOMMONTICKETCOMP": 0.03260000000000007, "SUBSEASONSPERYEAR": 0.012600000000000056, "GUESTBEHAVIOR": 0.00880000000000003, "TOTALVISITS": 0.007600000000000051, "AGE": 0.007199999999999984, "DESTINATIONGEOAFINITYLABEL": 0.007000000000000006, "ISEPICMIXACTIVATED": 0.005400000000000071, "RESORTSVISITED": 0.0046000000000000485, "MOSTVISITEDREGION": 0.0041999999999999815}, "test_metrics": {"auc": 0.8964439330564595, "acc": 0.8288888888888889, "bacc": 0.8290411310673139}, "fi_test": {"EVERPASS": 0.2577777777777778, "MOSTCOMMONTICKETCOMP": 0.028888888888888853, "SUBSEASONSPERYEAR": 0.02444444444444449, "TOTALVISITS": 0.015555555555555545, "GUESTBEHAVIOR": 0.012222222222222245, "TOTALSEASONSSCANNED": 0.008888888888888946, "DESTINATIONGEOAFINITYLABEL": 0.005555555555555536, "MOSTVISITEDRESORT": 0.0033333333333332993, "EVERCOREPASS": 0.0022222222222222365, "MARKETINGZONE": 0.0011111111111111738}}'
 'NOHYPEROPT' True False False]
INFO:root:Saving model and sending it to adls
INFO:root:Pushing Sklearn Object to Azure: projects/LTBP/FY23/experiments/NOHYPEROPT/modeling/train_xgb_basic/train_xgb_basicLocalRunTestNOHYPEROPT.pkl
INFO:data_system_utilities.azure.storage:Uploading train_xgb_basicLocalRunTestNOHYPEROPT.pkl, to Azure Storage projects/LTBP/FY23/experiments/NOHYPEROPT/modeling/train_xgb_basic/train_xgb_basicLocalRunTestNOHYPEROPT.pkl
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:root:train_xgb_basicLocalRunTestNOHYPEROPT.pkl successfully pushed to projects/LTBP/FY23/experiments/NOHYPEROPT/modeling/train_xgb_basic</code></pre>
</div>
</div>
<section id="results-1" class="level3">
<h3 class="anchored" data-anchor-id="results-1">Results</h3>
<p><strong>ADLS</strong></p>
<p>Created in this call are as follows:</p>
<ol type="1">
<li><p>x and y preprocessor</p>
<ul>
<li>projects/LTBP/FY23/experiments/BASELINE/preprocessors/train_xgb/</li>
</ul></li>
<li><p>Sklearn Pipeline Model</p>
<ul>
<li>projects/LTBP/FY23/experiments/BASELINE/modeling/train_xgb/</li>
</ul></li>
<li><p>Hold out results for this model in this experiment</p>
<ul>
<li>projects/LTBP/FY23/experiments/BASELINE/holdout_results/train_xgb/</li>
</ul></li>
</ol>
<p><strong>Snowflake</strong></p>
<p>A project log for the current run this is a new standard approach that for model promotions needs a quick PR to allow for models being put into production. Similar to how the legacy project currently support something like PROD_MODEL and have it be a BOOL type if True this is what the schedule of this repo uses to go find the production model in adls. We might also want to have something like EVER_PROD_MODEL to allow a user to know what models in the project log made it to production</p>
<blockquote class="blockquote">
<p>As of Nov 2nd this template doesn’t support the inference only runs, but it will soon</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT * </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY TIMESTAMP DESC</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 1</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ACTION_DESCRIPTION</th>
      <th>TRANSACTION_TYPE</th>
      <th>COMMITID</th>
      <th>ENVIRONMENT</th>
      <th>BRANCH</th>
      <th>TIMESTAMP</th>
      <th>ARTIFACTS</th>
      <th>METRICS</th>
      <th>EXPERIMENT_NAME</th>
      <th>EXPERIMENT</th>
      <th>PRODUCTION_MODEL</th>
      <th>EVER_PRODUCTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Only here to see if it works delete at some po...</td>
      <td>model_training</td>
      <td>LocalRunTest</td>
      <td>dev</td>
      <td>random</td>
      <td>2022-11-03 17:54:17</td>
      <td>{"azure_parent_folder": "projects/LTBP/FY23/ex...</td>
      <td>{"training_metrics": {"auc": 0.923350305191059...</td>
      <td>NOHYPEROPT</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>A hold out test set that gets sent to snowflake for post analysis work if a data scientist wants to look at where the model is doing well or even how well does this model extrapolate over season years for example in LTBP’s case</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT * </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.DEV.LTBP_HOLDOUT_TEST_MODEL_RESULTS</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ECID</th>
      <th>SEASONYEAR</th>
      <th>PROBABILITY</th>
      <th>DATECREATED</th>
      <th>EXP_COMMIT_CI_SHA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25115976</td>
      <td>2019/20</td>
      <td>0.386076</td>
      <td>2022-11-03 11:11:13</td>
      <td>BASELINE_LocalRunTest</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5198697</td>
      <td>2018/19</td>
      <td>0.392566</td>
      <td>2022-11-03 11:11:13</td>
      <td>BASELINE_LocalRunTest</td>
    </tr>
    <tr>
      <th>2</th>
      <td>86694567</td>
      <td>2018/19</td>
      <td>0.385913</td>
      <td>2022-11-03 11:11:13</td>
      <td>BASELINE_LocalRunTest</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17645838</td>
      <td>2018/19</td>
      <td>0.395433</td>
      <td>2022-11-03 11:11:13</td>
      <td>BASELINE_LocalRunTest</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11271320</td>
      <td>2018/19</td>
      <td>0.394330</td>
      <td>2022-11-03 11:11:13</td>
      <td>BASELINE_LocalRunTest</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="infer-model-results" class="level2">
<h2 class="anchored" data-anchor-id="infer-model-results">Infer Model Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> model_inference <span class="op">--</span>sfSchema <span class="st">'dev'</span> <span class="op">--</span>experiment_name <span class="st">'BASELINE'</span> <span class="op">--</span>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:data_system_utilities.snowflake.utils:stage_query: 
 create or replace stage ltbpFY23LocalRunTest
url='azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/experiments/BASELINE'
credentials=(azure_sas_token='**MASKED**')
encryption=(type= 'NONE')
file_format = (type = parquet        )
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Stage area LTBPFY23LOCALRUNTEST successfully created.
INFO:root:adls snowflake stage query 
    select
    $1:"ECID"::varchar as ECID
, $1:"SEASONYEAR"::varchar as SEASONYEAR
, $1:"AGE"::varchar as AGE
, $1:"AVGVISITPERSEASON"::varchar as AVGVISITPERSEASON
, $1:"BOUGHTPASS"::varchar as BOUGHTPASS
, $1:"DESTINATIONGEOAFINITYLABEL"::varchar as DESTINATIONGEOAFINITYLABEL
, $1:"EVERCOREPASS"::varchar as EVERCOREPASS
, $1:"EVERPASS"::varchar as EVERPASS
, $1:"GENDERCODE"::varchar as GENDERCODE
, $1:"GUESTBEHAVIOR"::varchar as GUESTBEHAVIOR
, $1:"ISEPICMIXACTIVATED"::varchar as ISEPICMIXACTIVATED
, $1:"MARKETINGZONE"::varchar as MARKETINGZONE
, $1:"MOSTCOMMONTICKETCOMP"::varchar as MOSTCOMMONTICKETCOMP
, $1:"MOSTSUBSEASONVISITED"::varchar as MOSTSUBSEASONVISITED
, $1:"MOSTVISITEDREGION"::varchar as MOSTVISITEDREGION
, $1:"MOSTVISITEDRESORT"::varchar as MOSTVISITEDRESORT
, $1:"ONLYSINGLERESORTKEY"::varchar as ONLYSINGLERESORTKEY
, $1:"PARTNERRESORTSCANNERFLAG"::varchar as PARTNERRESORTSCANNERFLAG
, $1:"RESORTSVISITED"::varchar as RESORTSVISITED
, $1:"SKIERABILITYLABEL"::varchar as SKIERABILITYLABEL
, $1:"SUBSEASONSPERYEAR"::varchar as SUBSEASONSPERYEAR
, $1:"TOTALSEASONSSCANNED"::varchar as TOTALSEASONSSCANNED
, $1:"TOTALVISITS"::varchar as TOTALVISITS
, $1:"VISITMOSTINPEAK"::varchar as VISITMOSTINPEAK

    from @ltbpFY23LocalRunTest/inference_data/
    LIMIT 1000
    
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:Preview dataframe queried        ECID SEASONYEAR AGE  ... TOTALSEASONSSCANNED TOTALVISITS VISITMOSTINPEAK
0   4274289    2021/22  33  ...                   0           0               0
1  83442101    2021/22  40  ...                   0           0               0
2   7327662    2021/22  17  ...                   0           0               0
3   6579493    2021/22  63  ...                   0           0               0
4  59180198    2021/22  35  ...                   0           0               0

[5 rows x 24 columns]
INFO:root:Loading Sklearn Object to: ./models/train_xgbLocalRunTestBASELINE.pkl
INFO:data_system_utilities.azure.storage:Downloading projects/LTBP/FY23/experiments/BASELINE/modeling/train_xgb/train_xgbLocalRunTestBASELINE.pkl to ./models/train_xgbLocalRunTestBASELINE.pkl
INFO:data_system_utilities.azure.storage:Download complete
INFO:root:Sklearn Object Loaded
INFO:root:preview predictions being added:
       ECID SEASONYEAR  ...         DATE_CREATED EXPERIMENT
0   4274289    2021/22  ...  2022-11-03 16:54:50   BASELINE
1  83442101    2021/22  ...  2022-11-03 16:54:50   BASELINE
2   7327662    2021/22  ...  2022-11-03 16:54:50   BASELINE

[3 rows x 6 columns]
INFO:root:preview predictions values addes:
['4274289' '2021/22' 0.04792783 'LocalRunTest' '2022-11-03 16:54:50'
 'BASELINE']
INFO:root:preview predictions being added columns:
Index(['ECID', 'SEASONYEAR', 'PROBABILITY', 'CI_COMMIT_SHA', 'DATE_CREATED',
       'EXPERIMENT'],
      dtype='object')
INFO:data_system_utilities.azure.storage:Uploading predictions_LocalRunTestBASELINE.csv, to Azure Storage projects/LTBP/FY23/experiments/BASELINE/predictions/train_xgb/predictions_LocalRunTestBASELINE.csv
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:
        create or replace table LTBP_PREDICTIONS_FY23 (ECID VARCHAR, SEASONYEAR VARCHAR, PROBABILITY FLOAT, CI_COMMIT_SHA VARCHAR, DATE_CREATED VARCHAR, EXPERIMENT VARCHAR);
        
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Table LTBP_PREDICTIONS_FY23 successfully created.
INFO:root:Pushing Forecasted Season from ADLS to Snowflake
INFO:data_system_utilities.snowflake.copyinto:
copy into MACHINELEARNINGOUTPUTS.dev.LTBP_PREDICTIONS_FY23
from 'azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/experiments/BASELINE/predictions/train_xgb/predictions_LocalRunTestBASELINE.csv'
file_format = (type = csv     skip_header = 1)
credentials= (azure_sas_token = '?sv=2019-12-12&amp;ss=bfqt&amp;srt=sco&amp;sp=rwdlacupx&amp;se=2031-01-22T06:17:14Z&amp;st=2021-01-21T22:17:14Z&amp;spr=https&amp;sig=kIHogByJjyVWyL6XupA0CBUB1iw12%2FeXWFQiOj5fB5c%3D')
pattern = '.*.csv';
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:preview of queried table being added:
       ECID SEASONYEAR  ...         DATE_CREATED EXPERIMENT
0   4274289    2021/22  ...  2022-11-03 16:54:50   BASELINE
1  83442101    2021/22  ...  2022-11-03 16:54:50   BASELINE
2   7327662    2021/22  ...  2022-11-03 16:54:50   BASELINE

[3 rows x 6 columns]
INFO:root:preview predictions values addes:
['4274289' '2021/22' 0.04792783 'LocalRunTest' '2022-11-03 16:54:50'
 'BASELINE']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> model_inference <span class="op">--</span>sfSchema <span class="st">'dev'</span> <span class="op">--</span>experiment_name <span class="st">'NOHYPEROPT'</span> <span class="op">--</span>experiment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:data_system_utilities.snowflake.utils:stage_query: 
 create or replace stage ltbpFY23LocalRunTest
url='azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/experiments/NOHYPEROPT'
credentials=(azure_sas_token='**MASKED**')
encryption=(type= 'NONE')
file_format = (type = parquet        )
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Stage area LTBPFY23LOCALRUNTEST successfully created.
INFO:root:adls snowflake stage query 
    select
    $1:"ECID"::varchar as ECID
, $1:"SEASONYEAR"::varchar as SEASONYEAR
, $1:"AGE"::varchar as AGE
, $1:"AVGVISITPERSEASON"::varchar as AVGVISITPERSEASON
, $1:"BOUGHTPASS"::varchar as BOUGHTPASS
, $1:"DESTINATIONGEOAFINITYLABEL"::varchar as DESTINATIONGEOAFINITYLABEL
, $1:"EVERCOREPASS"::varchar as EVERCOREPASS
, $1:"EVERPASS"::varchar as EVERPASS
, $1:"GENDERCODE"::varchar as GENDERCODE
, $1:"GUESTBEHAVIOR"::varchar as GUESTBEHAVIOR
, $1:"ISEPICMIXACTIVATED"::varchar as ISEPICMIXACTIVATED
, $1:"MARKETINGZONE"::varchar as MARKETINGZONE
, $1:"MOSTCOMMONTICKETCOMP"::varchar as MOSTCOMMONTICKETCOMP
, $1:"MOSTSUBSEASONVISITED"::varchar as MOSTSUBSEASONVISITED
, $1:"MOSTVISITEDREGION"::varchar as MOSTVISITEDREGION
, $1:"MOSTVISITEDRESORT"::varchar as MOSTVISITEDRESORT
, $1:"ONLYSINGLERESORTKEY"::varchar as ONLYSINGLERESORTKEY
, $1:"PARTNERRESORTSCANNERFLAG"::varchar as PARTNERRESORTSCANNERFLAG
, $1:"RESORTSVISITED"::varchar as RESORTSVISITED
, $1:"SKIERABILITYLABEL"::varchar as SKIERABILITYLABEL
, $1:"SUBSEASONSPERYEAR"::varchar as SUBSEASONSPERYEAR
, $1:"TOTALSEASONSSCANNED"::varchar as TOTALSEASONSSCANNED
, $1:"TOTALVISITS"::varchar as TOTALVISITS
, $1:"VISITMOSTINPEAK"::varchar as VISITMOSTINPEAK

    from @ltbpFY23LocalRunTest/inference_data/
    LIMIT 1000
    
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:Preview dataframe queried        ECID SEASONYEAR  AGE  ... TOTALSEASONSSCANNED TOTALVISITS VISITMOSTINPEAK
0   3396514    2021/22   38  ...                   0           0               0
1  57254352    2021/22   21  ...                   0           0               0
2  60713843    2021/22   10  ...                   0           0               0
3   7505200    2021/22  119  ...                   0           0               0
4  37310378    2021/22   16  ...                   0           0               0

[5 rows x 24 columns]
INFO:root:Loading Sklearn Object to: ./models/train_xgb_basicLocalRunTestNOHYPEROPT.pkl
INFO:data_system_utilities.azure.storage:Downloading projects/LTBP/FY23/experiments/NOHYPEROPT/modeling/train_xgb_basic/train_xgb_basicLocalRunTestNOHYPEROPT.pkl to ./models/train_xgb_basicLocalRunTestNOHYPEROPT.pkl
INFO:data_system_utilities.azure.storage:Download complete
INFO:root:Sklearn Object Loaded
INFO:root:preview predictions being added:
       ECID SEASONYEAR  ...         DATE_CREATED  EXPERIMENT
0   3396514    2021/22  ...  2022-11-03 16:55:02  NOHYPEROPT
1  57254352    2021/22  ...  2022-11-03 16:55:02  NOHYPEROPT
2  60713843    2021/22  ...  2022-11-03 16:55:02  NOHYPEROPT

[3 rows x 6 columns]
INFO:root:preview predictions values addes:
['3396514' '2021/22' 0.032057054 'LocalRunTest' '2022-11-03 16:55:02'
 'NOHYPEROPT']
INFO:root:preview predictions being added columns:
Index(['ECID', 'SEASONYEAR', 'PROBABILITY', 'CI_COMMIT_SHA', 'DATE_CREATED',
       'EXPERIMENT'],
      dtype='object')
INFO:data_system_utilities.azure.storage:Uploading predictions_LocalRunTestNOHYPEROPT.csv, to Azure Storage projects/LTBP/FY23/experiments/NOHYPEROPT/predictions/train_xgb_basic/predictions_LocalRunTestNOHYPEROPT.csv
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:Pushing Forecasted Season from ADLS to Snowflake
INFO:data_system_utilities.snowflake.copyinto:
copy into MACHINELEARNINGOUTPUTS.dev.LTBP_PREDICTIONS_FY23
from 'azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/experiments/NOHYPEROPT/predictions/train_xgb_basic/predictions_LocalRunTestNOHYPEROPT.csv'
file_format = (type = csv     skip_header = 1)
credentials= (azure_sas_token = '?sv=2019-12-12&amp;ss=bfqt&amp;srt=sco&amp;sp=rwdlacupx&amp;se=2031-01-22T06:17:14Z&amp;st=2021-01-21T22:17:14Z&amp;spr=https&amp;sig=kIHogByJjyVWyL6XupA0CBUB1iw12%2FeXWFQiOj5fB5c%3D')
pattern = '.*.csv';
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:preview of queried table being added:
       ECID SEASONYEAR  ...         DATE_CREATED  EXPERIMENT
0   3396514    2021/22  ...  2022-11-03 16:55:02  NOHYPEROPT
1  57254352    2021/22  ...  2022-11-03 16:55:02  NOHYPEROPT
2  60713843    2021/22  ...  2022-11-03 16:55:02  NOHYPEROPT

[3 rows x 6 columns]
INFO:root:preview predictions values addes:
['3396514' '2021/22' 0.032057054 'LocalRunTest' '2022-11-03 16:55:02'
 'NOHYPEROPT']</code></pre>
</div>
</div>
<section id="results-2" class="level3">
<h3 class="anchored" data-anchor-id="results-2">Results</h3>
<p><strong>ADLS</strong></p>
<p>A .csv file is sent to the following location and the reason that it’s in a .csv file is that it isn’t huge and is only sent to snowflake once and it’s sometimes nice to be able to pull down the file and look into it and parquet files don’t allow you to do that, but completely open to changing this process</p>
<ul>
<li>projects/LTBP/FY23/experiments/BASELINE/predictions/train_xgb/</li>
</ul>
<p><strong>Snowflake</strong></p>
<p>The an inference table is set up and at the current moment we are appending to the inference table this could change shortly, but for right now your inference table can be unique with your DATE_CREATED + EXPERIMENT. During iteration of this quick process understanding what is desired is part of this and there can be value in having the last runs predictions in the database.</p>
<p>Looking for input on this</p>
<blockquote class="blockquote">
<p>Note: For the production run version creating an archive of all the runs that occur for a production level run seems like a pretty good way to save ourselves trouble, but again all the predictions will always be recoverable inside of adls.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT * </span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.DEV.LTBP_PREDICTIONS_FY23</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY DATE_CREATED DESC</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ECID</th>
      <th>SEASONYEAR</th>
      <th>PROBABILITY</th>
      <th>CI_COMMIT_SHA</th>
      <th>DATE_CREATED</th>
      <th>EXPERIMENT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7505200</td>
      <td>2021/22</td>
      <td>0.049381</td>
      <td>LocalRunTest</td>
      <td>2022-11-03 16:55:02</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57254352</td>
      <td>2021/22</td>
      <td>0.020158</td>
      <td>LocalRunTest</td>
      <td>2022-11-03 16:55:02</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3396514</td>
      <td>2021/22</td>
      <td>0.032057</td>
      <td>LocalRunTest</td>
      <td>2022-11-03 16:55:02</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>37310378</td>
      <td>2021/22</td>
      <td>0.018215</td>
      <td>LocalRunTest</td>
      <td>2022-11-03 16:55:02</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>4</th>
      <td>60713843</td>
      <td>2021/22</td>
      <td>0.096196</td>
      <td>LocalRunTest</td>
      <td>2022-11-03 16:55:02</td>
      <td>NOHYPEROPT</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT DISTINCT DATE_CREATED, EXPERIMENT</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.DEV.LTBP_PREDICTIONS_FY23</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>DATE_CREATED</th>
      <th>EXPERIMENT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-11-03 16:54:50</td>
      <td>BASELINE</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-11-03 16:55:02</td>
      <td>NOHYPEROPT</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="model-promotion" class="level2">
<h2 class="anchored" data-anchor-id="model-promotion">Model Promotion</h2>
<p>Lets say this experiment is the model that you are so happy with and you didn’t want to run it in a gitlab/github pipeline to get the results you can always promote a model to production because schedule inference runs will only be pulling inference data and running the model inference and post analysis that is custom to your project</p>
<p><strong>Why?</strong></p>
<p>So the question you might be asking is why wouldn’t I just promote the model that I just ran to prod or make a copy of it in a “production schema” well that could happen but we like to be module in the approach we take as well as you need to be very intentional to overwrite the results in prod.</p>
<p>The long story short is that it forces you to think about the promotion of a model before letting it happen. It is manual, but it is manual for the reason to slow you down</p>
<p><strong>How</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT * </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ACTION_DESCRIPTION</th>
      <th>TRANSACTION_TYPE</th>
      <th>COMMITID</th>
      <th>ENVIRONMENT</th>
      <th>BRANCH</th>
      <th>TIMESTAMP</th>
      <th>ARTIFACTS</th>
      <th>METRICS</th>
      <th>EXPERIMENT_NAME</th>
      <th>EXPERIMENT</th>
      <th>PRODUCTION_MODEL</th>
      <th>EVER_PRODUCTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Standard baseline xgb_hyperopt approach status...</td>
      <td>model_training</td>
      <td>LocalRunTest</td>
      <td>dev</td>
      <td>random</td>
      <td>2022-11-03 17:53:58</td>
      <td>{"azure_parent_folder": "projects/LTBP/FY23/ex...</td>
      <td>{"training_metrics": {"auc": 0.901687451479167...</td>
      <td>BASELINE</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Only here to see if it works delete at some po...</td>
      <td>model_training</td>
      <td>LocalRunTest</td>
      <td>dev</td>
      <td>random</td>
      <td>2022-11-03 17:54:17</td>
      <td>{"azure_parent_folder": "projects/LTBP/FY23/ex...</td>
      <td>{"training_metrics": {"auc": 0.923350305191059...</td>
      <td>NOHYPEROPT</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If this is your first time then you should not have any production models created for this project already</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT * </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE PRODUCTION_MODEL</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ACTION_DESCRIPTION</th>
      <th>TRANSACTION_TYPE</th>
      <th>COMMITID</th>
      <th>ENVIRONMENT</th>
      <th>BRANCH</th>
      <th>TIMESTAMP</th>
      <th>ARTIFACTS</th>
      <th>METRICS</th>
      <th>EXPERIMENT_NAME</th>
      <th>EXPERIMENT</th>
      <th>PRODUCTION_MODEL</th>
      <th>EVER_PRODUCTION</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
<p>So to promote this model we will need to update it and an easy way to do this is with the UPDATE command</p>
<p>There are of course other ways to do this in type of modeling approach you can come up with a custom post analysis work stream that promotes the model that is the best base on w/e kind of metrics you want, but this is how you can do it in the simplest approach</p>
<p>Here we are pushing two models to production to make sure the process works for two models that you may want to have this ability for an ensemble or a specific category of guest that the model works well for so that you can build a view on top of this table to allow the business to query off</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''UPDATE MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="st">SET PRODUCTION_MODEL = True</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE COMMITID = 'LocalRunTest'</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="st">AND EXPERIMENT_NAME = 'BASELINE'</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="st">AND EXPERIMENT = 'True'</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="st">AND CAST(TIMESTAMP as VARCHAR) = '2022-11-03 17:53:58'</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''UPDATE MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="st">SET PRODUCTION_MODEL = True</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE COMMITID = 'LocalRunTest'</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="st">AND EXPERIMENT_NAME = 'NOHYPEROPT'</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="st">AND EXPERIMENT = 'True'</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="st">AND CAST(TIMESTAMP as VARCHAR) = '2022-11-03 17:54:17'</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT * </span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE PRODUCTION_MODEL</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ACTION_DESCRIPTION</th>
      <th>TRANSACTION_TYPE</th>
      <th>COMMITID</th>
      <th>ENVIRONMENT</th>
      <th>BRANCH</th>
      <th>TIMESTAMP</th>
      <th>ARTIFACTS</th>
      <th>METRICS</th>
      <th>EXPERIMENT_NAME</th>
      <th>EXPERIMENT</th>
      <th>PRODUCTION_MODEL</th>
      <th>EVER_PRODUCTION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Standard baseline xgb_hyperopt approach status...</td>
      <td>model_training</td>
      <td>LocalRunTest</td>
      <td>dev</td>
      <td>random</td>
      <td>2022-11-03 17:53:58</td>
      <td>{"azure_parent_folder": "projects/LTBP/FY23/ex...</td>
      <td>{"training_metrics": {"auc": 0.901687451479167...</td>
      <td>BASELINE</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Only here to see if it works delete at some po...</td>
      <td>model_training</td>
      <td>LocalRunTest</td>
      <td>dev</td>
      <td>random</td>
      <td>2022-11-03 17:54:17</td>
      <td>{"azure_parent_folder": "projects/LTBP/FY23/ex...</td>
      <td>{"training_metrics": {"auc": 0.923350305191059...</td>
      <td>NOHYPEROPT</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><strong>Important</strong></p>
<p>Never forget to set your other model to a no longer production model, but a past production model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''UPDATE MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="st">SET PRODUCTION_MODEL = False, EVER_PRODUCTION = True</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE COMMITID = 'LocalRunTest'</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="st">AND EXPERIMENT_NAME = 'BASELINE'</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="st">AND EXPERIMENT = 'True'</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="st">AND CAST(TIMESTAMP as VARCHAR) = '2022-11-03 12:11:18' --Here to show what it might look like</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT * </span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE EVER_PRODUCTION</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ACTION_DESCRIPTION</th>
      <th>TRANSACTION_TYPE</th>
      <th>COMMITID</th>
      <th>ENVIRONMENT</th>
      <th>BRANCH</th>
      <th>TIMESTAMP</th>
      <th>ARTIFACTS</th>
      <th>METRICS</th>
      <th>EXPERIMENT_NAME</th>
      <th>EXPERIMENT</th>
      <th>PRODUCTION_MODEL</th>
      <th>EVER_PRODUCTION</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="production-level-run" class="level2">
<h2 class="anchored" data-anchor-id="production-level-run">Production Level Run</h2>
<p>Awesome, there is a model that is ready to be predicted on lets go ahead and show what would be needed to run an inference only pipeline</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> data_creation  <span class="op">--</span>train_or_inference <span class="st">"INFERENCE"</span> <span class="op">--</span>experiment_name <span class="st">"BASELINE"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:root:This is a production run
INFO:root:Loading Yaml Files..
INFO:root:Generating Feature Set Query
INFO:root:static features in data set: 
 ['DESTINATIONGEOAFINITYLABEL', 'GenderCode']
INFO:root:temporal features in data set: 
 ['Age', 'AvgVisitPerSeason', 'BoughtPass', 'EverCorePass', 'EverPass', 'GuestBehavior', 'IsEpicMixActivated', 'MarketingZone', 'MostCommonTicketComp', 'MostSubSeasonVisited', 'MostVisitedRegion', 'MostVisitedResort', 'OnlySingleResortKey', 'PartnerResortScannerFlag', 'ResortsVisited', 'SkierabilityLabel', 'SubSeasonsPerYear', 'TotalSeasonsScanned', 'TotalVisits', 'VisitMostInPeak']
INFO:root:Appending static feature DESTINATIONGEOAFINITYLABEL to query
INFO:root:Appending static feature GenderCode to query
INFO:root:Finished appending static features
INFO:root:reading inference_base.sql for base query...
INFO:root:final query output: 
 select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20190101, 20221005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20190101, 20221005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2021/22') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2021/22') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2021/22') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2021/22') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20190101, 20221005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20190101, 20221005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20190101, 20221005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2021/22') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20190101, 20221005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20190101, 20221005) as VisitMostInPeak

, '2021/22' as SEASONYEAR
from
(-- base EDEE team guest behavior
  with edee_base as (
      SELECT 
            distinct ECID
      from BIDE_EDWDB_CUSTOMERMART_PROD.DBO.CustomerPASSPURCHASEBEHAVIOR cla
      where 
              cla.GuestPassPurchaseBehaviorDetailLabel &lt;&gt; 'Unknown'
  ),

  -- pass prospects not in guest behavior
  prospects as (
      Select
            distinct ECID
      from Vail_Reporting.Prod.GuestBehaviorBase
      where 
              GuestBehavior = 'Prospect'
          and salesseason = '2021/22'
  ),

  -- paid prospects not in guest behavior
  other_scans as (
      select
            distinct a.ECID
      from
      (
          select 
                distinct ECID
              , SeasonYear
          from "BIDE_EDWDB_ARA_PROD"."DBO"."SCANDAY"
              where Season = 'Winter'
      ) a
      left join Vail_Reporting.Prod.GuestBehaviorBase b 
          on a.ECID = b.ECID and a.SeasonYear = b.SalesSeason
      where 
              b.GuestBehavior is null
          and a.seasonyear = '2021/22'
  )

  select
        distinct ECID
      , 'Inference Set' as SeasonYear
  from
  (
      select
            coalesce(base.ecid, pro.ecid, os.ecid) as ecid
      from edee_base base
      full outer join prospects pro
          on pro.ecid = base.ecid
      full outer join other_scans os
          on os.ecid = base.ecid
  ) a)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid
INFO:root:Checking projects/LTBP/FY23/LocalRunTest/BASELINE/inference_data/ to either skip creation for experiment or create a production dataset
INFO:data_system_utilities.azure.storage:number of files in container path recursively 0
INFO:data_system_utilities.snowflake.copyinto:
COPY INTO 'azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/LocalRunTest/BASELINE/inference_data/'
FROM (select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20190101, 20221005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20190101, 20221005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2021/22') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2021/22') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2021/22') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2021/22') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20190101, 20221005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20190101, 20221005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20190101, 20221005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2021/22') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20190101, 20221005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20190101, 20221005) as VisitMostInPeak

, '2021/22' as SEASONYEAR
from
(-- base EDEE team guest behavior
  with edee_base as (
      SELECT 
            distinct ECID
      from BIDE_EDWDB_CUSTOMERMART_PROD.DBO.CustomerPASSPURCHASEBEHAVIOR cla
      where 
              cla.GuestPassPurchaseBehaviorDetailLabel &lt;&gt; 'Unknown'
  ),

  -- pass prospects not in guest behavior
  prospects as (
      Select
            distinct ECID
      from Vail_Reporting.Prod.GuestBehaviorBase
      where 
              GuestBehavior = 'Prospect'
          and salesseason = '2021/22'
  ),

  -- paid prospects not in guest behavior
  other_scans as (
      select
            distinct a.ECID
      from
      (
          select 
                distinct ECID
              , SeasonYear
          from "BIDE_EDWDB_ARA_PROD"."DBO"."SCANDAY"
              where Season = 'Winter'
      ) a
      left join Vail_Reporting.Prod.GuestBehaviorBase b 
          on a.ECID = b.ECID and a.SeasonYear = b.SalesSeason
      where 
              b.GuestBehavior is null
          and a.seasonyear = '2021/22'
  )

  select
        distinct ECID
      , 'Inference Set' as SeasonYear
  from
  (
      select
            coalesce(base.ecid, pro.ecid, os.ecid) as ecid
      from edee_base base
      full outer join prospects pro
          on pro.ecid = base.ecid
      full outer join other_scans os
          on os.ecid = base.ecid
  ) a)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid)

max_file_size = 3200000
overwrite = True
file_format = (type = parquet          )
credentials= (azure_sas_token = '**MASKED**')
header = True;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:data has been delivered from sf to adls</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> data_creation  <span class="op">--</span>train_or_inference <span class="st">"INFERENCE"</span> <span class="op">--</span>experiment_name <span class="st">"NOHYPEROPT"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:root:This is a production run
INFO:root:Loading Yaml Files..
INFO:root:Generating Feature Set Query
INFO:root:static features in data set: 
 ['DESTINATIONGEOAFINITYLABEL', 'GenderCode']
INFO:root:temporal features in data set: 
 ['Age', 'AvgVisitPerSeason', 'BoughtPass', 'EverCorePass', 'EverPass', 'GuestBehavior', 'IsEpicMixActivated', 'MarketingZone', 'MostCommonTicketComp', 'MostSubSeasonVisited', 'MostVisitedRegion', 'MostVisitedResort', 'OnlySingleResortKey', 'PartnerResortScannerFlag', 'ResortsVisited', 'SkierabilityLabel', 'SubSeasonsPerYear', 'TotalSeasonsScanned', 'TotalVisits', 'VisitMostInPeak']
INFO:root:Appending static feature DESTINATIONGEOAFINITYLABEL to query
INFO:root:Appending static feature GenderCode to query
INFO:root:Finished appending static features
INFO:root:reading inference_base.sql for base query...
INFO:root:final query output: 
 select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20190101, 20221005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20190101, 20221005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2021/22') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2021/22') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2021/22') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2021/22') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20190101, 20221005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20190101, 20221005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20190101, 20221005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2021/22') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20190101, 20221005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20190101, 20221005) as VisitMostInPeak

, '2021/22' as SEASONYEAR
from
(-- base EDEE team guest behavior
  with edee_base as (
      SELECT 
            distinct ECID
      from BIDE_EDWDB_CUSTOMERMART_PROD.DBO.CustomerPASSPURCHASEBEHAVIOR cla
      where 
              cla.GuestPassPurchaseBehaviorDetailLabel &lt;&gt; 'Unknown'
  ),

  -- pass prospects not in guest behavior
  prospects as (
      Select
            distinct ECID
      from Vail_Reporting.Prod.GuestBehaviorBase
      where 
              GuestBehavior = 'Prospect'
          and salesseason = '2021/22'
  ),

  -- paid prospects not in guest behavior
  other_scans as (
      select
            distinct a.ECID
      from
      (
          select 
                distinct ECID
              , SeasonYear
          from "BIDE_EDWDB_ARA_PROD"."DBO"."SCANDAY"
              where Season = 'Winter'
      ) a
      left join Vail_Reporting.Prod.GuestBehaviorBase b 
          on a.ECID = b.ECID and a.SeasonYear = b.SalesSeason
      where 
              b.GuestBehavior is null
          and a.seasonyear = '2021/22'
  )

  select
        distinct ECID
      , 'Inference Set' as SeasonYear
  from
  (
      select
            coalesce(base.ecid, pro.ecid, os.ecid) as ecid
      from edee_base base
      full outer join prospects pro
          on pro.ecid = base.ecid
      full outer join other_scans os
          on os.ecid = base.ecid
  ) a)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid
INFO:root:Checking projects/LTBP/FY23/LocalRunTest/NOHYPEROPT/inference_data/ to either skip creation for experiment or create a production dataset
INFO:data_system_utilities.azure.storage:number of files in container path recursively 0
INFO:data_system_utilities.snowflake.copyinto:
COPY INTO 'azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/LocalRunTest/NOHYPEROPT/inference_data/'
FROM (select
base.*
, joined.DESTINATIONGEOAFINITYLABEL
, joined.GenderCode
, MACHINELEARNINGFEATURES.PROD.Age_ECID_Temporal(base.ECID, 20190101, 20221005) as Age, MACHINELEARNINGFEATURES.PROD.AvgVisitPerSeason_ECID_Temporal(base.ECID, 20190101, 20221005) as AvgVisitPerSeason, MACHINELEARNINGFEATURES.PROD.BoughtPass_ECID_Temporal(base.ECID, '2021/22') as BoughtPass, MACHINELEARNINGFEATURES.PROD.EverCorePass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverCorePass, MACHINELEARNINGFEATURES.PROD.EverPass_ECID_Temporal(base.ECID, 20051001, 20221005) as EverPass, MACHINELEARNINGFEATURES.PROD.GuestBehavior_ECID_Temporal(base.ECID, '2021/22') as GuestBehavior, MACHINELEARNINGFEATURES.PROD.IsEpicMixActivated_ECID_Temporal(base.ECID, '2021/22') as IsEpicMixActivated, MACHINELEARNINGFEATURES.PROD.MarketingZone_ECID_Temporal(base.ECID, '2021/22') as MarketingZone, MACHINELEARNINGFEATURES.PROD.MostCommonTicketComp_ECID_Temporal(base.ECID, 20190101, 20221005) as MostCommonTicketComp, MACHINELEARNINGFEATURES.PROD.MostSubSeasonVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as MostSubSeasonVisited, MACHINELEARNINGFEATURES.PROD.MostVisitedRegion_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedRegion, MACHINELEARNINGFEATURES.PROD.MostVisitedResort_ECID_Temporal(base.ECID, 20190101, 20221005) as MostVisitedResort, MACHINELEARNINGFEATURES.PROD.OnlySingleResortKey_ECID_Temporal(base.ECID, 20190101, 20221005) as OnlySingleResortKey, MACHINELEARNINGFEATURES.PROD.PartnerResortScannerFlag_ECID_Temporal(base.ECID, 20190101, 20221005) as PartnerResortScannerFlag, MACHINELEARNINGFEATURES.PROD.ResortsVisited_ECID_Temporal(base.ECID, 20190101, 20221005) as ResortsVisited, MACHINELEARNINGFEATURES.PROD.SkierabilityLabel_ECID_Temporal(base.ECID, '2021/22') as SkierabilityLabel, MACHINELEARNINGFEATURES.PROD.SubSeasonsPerYear_ECID_Temporal(base.ECID, 20190101, 20221005) as SubSeasonsPerYear, MACHINELEARNINGFEATURES.PROD.TotalSeasonsScanned_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalSeasonsScanned, MACHINELEARNINGFEATURES.PROD.TotalVisits_ECID_Temporal(base.ECID, 20190101, 20221005) as TotalVisits, MACHINELEARNINGFEATURES.PROD.VisitMostInPeak_ECID_Temporal(base.ECID, 20190101, 20221005) as VisitMostInPeak

, '2021/22' as SEASONYEAR
from
(-- base EDEE team guest behavior
  with edee_base as (
      SELECT 
            distinct ECID
      from BIDE_EDWDB_CUSTOMERMART_PROD.DBO.CustomerPASSPURCHASEBEHAVIOR cla
      where 
              cla.GuestPassPurchaseBehaviorDetailLabel &lt;&gt; 'Unknown'
  ),

  -- pass prospects not in guest behavior
  prospects as (
      Select
            distinct ECID
      from Vail_Reporting.Prod.GuestBehaviorBase
      where 
              GuestBehavior = 'Prospect'
          and salesseason = '2021/22'
  ),

  -- paid prospects not in guest behavior
  other_scans as (
      select
            distinct a.ECID
      from
      (
          select 
                distinct ECID
              , SeasonYear
          from "BIDE_EDWDB_ARA_PROD"."DBO"."SCANDAY"
              where Season = 'Winter'
      ) a
      left join Vail_Reporting.Prod.GuestBehaviorBase b 
          on a.ECID = b.ECID and a.SeasonYear = b.SalesSeason
      where 
              b.GuestBehavior is null
          and a.seasonyear = '2021/22'
  )

  select
        distinct ECID
      , 'Inference Set' as SeasonYear
  from
  (
      select
            coalesce(base.ecid, pro.ecid, os.ecid) as ecid
      from edee_base base
      full outer join prospects pro
          on pro.ecid = base.ecid
      full outer join other_scans os
          on os.ecid = base.ecid
  ) a)base
inner join machinelearningfeatures.prod.featurestore_ecid joined on joined.ecid = base.ecid)

max_file_size = 3200000
overwrite = True
file_format = (type = parquet          )
credentials= (azure_sas_token = '**MASKED**')
header = True;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:data has been delivered from sf to adls</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> model_inference <span class="op">--</span>sfSchema <span class="st">'LTBP'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/Users/jeremydemlow/miniforge3/envs/ltbp/lib/python3.9/site-packages/snowflake/connector/options.py:96: UserWarning: You have an incompatible version of 'pyarrow' installed (6.0.0), please install a version that adheres to: 'pyarrow&lt;8.1.0,&gt;=8.0.0; extra == "pandas"'
  warn_incompatible_dep(
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Drop statement executed successfully (LTBP_PREDICTIONS_FY23 already dropped).
INFO:data_system_utilities.snowflake.utils:stage_query: 
 create or replace stage ltbpFY23LocalRunTest
url='azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/LocalRunTest/BASELINE/'
credentials=(azure_sas_token='**MASKED**')
encryption=(type= 'NONE')
file_format = (type = parquet        )
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Stage area LTBPFY23LOCALRUNTEST successfully created.
INFO:root:adls snowflake stage query 
    select
    $1:"ECID"::varchar as ECID
, $1:"SEASONYEAR"::varchar as SEASONYEAR
, $1:"AGE"::varchar as AGE
, $1:"AVGVISITPERSEASON"::varchar as AVGVISITPERSEASON
, $1:"BOUGHTPASS"::varchar as BOUGHTPASS
, $1:"DESTINATIONGEOAFINITYLABEL"::varchar as DESTINATIONGEOAFINITYLABEL
, $1:"EVERCOREPASS"::varchar as EVERCOREPASS
, $1:"EVERPASS"::varchar as EVERPASS
, $1:"GENDERCODE"::varchar as GENDERCODE
, $1:"GUESTBEHAVIOR"::varchar as GUESTBEHAVIOR
, $1:"ISEPICMIXACTIVATED"::varchar as ISEPICMIXACTIVATED
, $1:"MARKETINGZONE"::varchar as MARKETINGZONE
, $1:"MOSTCOMMONTICKETCOMP"::varchar as MOSTCOMMONTICKETCOMP
, $1:"MOSTSUBSEASONVISITED"::varchar as MOSTSUBSEASONVISITED
, $1:"MOSTVISITEDREGION"::varchar as MOSTVISITEDREGION
, $1:"MOSTVISITEDRESORT"::varchar as MOSTVISITEDRESORT
, $1:"ONLYSINGLERESORTKEY"::varchar as ONLYSINGLERESORTKEY
, $1:"PARTNERRESORTSCANNERFLAG"::varchar as PARTNERRESORTSCANNERFLAG
, $1:"RESORTSVISITED"::varchar as RESORTSVISITED
, $1:"SKIERABILITYLABEL"::varchar as SKIERABILITYLABEL
, $1:"SUBSEASONSPERYEAR"::varchar as SUBSEASONSPERYEAR
, $1:"TOTALSEASONSSCANNED"::varchar as TOTALSEASONSSCANNED
, $1:"TOTALVISITS"::varchar as TOTALVISITS
, $1:"VISITMOSTINPEAK"::varchar as VISITMOSTINPEAK

    from @ltbpFY23LocalRunTest/inference_data/
    LIMIT 1000
    
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:Preview dataframe queried        ECID SEASONYEAR AGE  ... TOTALSEASONSSCANNED TOTALVISITS VISITMOSTINPEAK
0   2327342    2021/22  26  ...                   0           0               0
1  20051369    2021/22  44  ...                   0           0               0
2  56109980    2021/22  48  ...                   0           0               0
3  48596844    2021/22  19  ...                   0           0               0
4  56486185    2021/22   7  ...                   0           0               0

[5 rows x 24 columns]
INFO:root:Loading Sklearn Object to: ./models/train_xgbLocalRunTestBASELINE.pkl
INFO:data_system_utilities.azure.storage:Downloading projects/LTBP/FY23/experiments/BASELINE/modeling/train_xgb/train_xgbLocalRunTestBASELINE.pkl to ./models/train_xgbLocalRunTestBASELINE.pkl
INFO:data_system_utilities.azure.storage:Download complete
INFO:root:Sklearn Object Loaded
INFO:root:preview predictions being added:
       ECID SEASONYEAR  ...         DATE_CREATED EXPERIMENT
0   2327342    2021/22  ...  2022-11-04 07:54:23   BASELINE
1  20051369    2021/22  ...  2022-11-04 07:54:23   BASELINE
2  56109980    2021/22  ...  2022-11-04 07:54:23   BASELINE

[3 rows x 6 columns]
INFO:root:preview predictions values addes:
['2327342' '2021/22' 0.0482946 'LocalRunTest' '2022-11-04 07:54:23'
 'BASELINE']
INFO:root:preview predictions being added columns:
Index(['ECID', 'SEASONYEAR', 'PROBABILITY', 'CI_COMMIT_SHA', 'DATE_CREATED',
       'EXPERIMENT'],
      dtype='object')
INFO:data_system_utilities.azure.storage:Uploading predictions_LocalRunTestBASELINE.csv, to Azure Storage projects/LTBP/FY23/LocalRunTest/BASELINE/predictions/train_xgb/predictions_LocalRunTestBASELINE.csv
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:
        create or replace table LTBP_PREDICTIONS_FY23 (ECID VARCHAR, SEASONYEAR VARCHAR, PROBABILITY FLOAT, CI_COMMIT_SHA VARCHAR, DATE_CREATED VARCHAR, EXPERIMENT VARCHAR);
        
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Table LTBP_PREDICTIONS_FY23 successfully created.
INFO:root:Pushing Forecasted Season from ADLS to Snowflake
INFO:data_system_utilities.snowflake.copyinto:
copy into MACHINELEARNINGOUTPUTS.LTBP.LTBP_PREDICTIONS_FY23
from 'azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/LocalRunTest/BASELINE/predictions/train_xgb/predictions_LocalRunTestBASELINE.csv'
file_format = (type = csv     skip_header = 1)
credentials= (azure_sas_token = '?sv=2019-12-12&amp;ss=bfqt&amp;srt=sco&amp;sp=rwdlacupx&amp;se=2031-01-22T06:17:14Z&amp;st=2021-01-21T22:17:14Z&amp;spr=https&amp;sig=kIHogByJjyVWyL6XupA0CBUB1iw12%2FeXWFQiOj5fB5c%3D')
pattern = '.*.csv';
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:preview of queried table being added:
       ECID SEASONYEAR  ...         DATE_CREATED EXPERIMENT
0   2327342    2021/22  ...  2022-11-04 07:54:23   BASELINE
1  20051369    2021/22  ...  2022-11-04 07:54:23   BASELINE
2  56109980    2021/22  ...  2022-11-04 07:54:23   BASELINE

[3 rows x 6 columns]
INFO:root:preview predictions values addes:
['2327342' '2021/22' 0.0482946 'LocalRunTest' '2022-11-04 07:54:23'
 'BASELINE']
INFO:data_system_utilities.snowflake.utils:stage_query: 
 create or replace stage ltbpFY23LocalRunTest
url='azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/LocalRunTest/NOHYPEROPT/'
credentials=(azure_sas_token='**MASKED**')
encryption=(type= 'NONE')
file_format = (type = parquet        )
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:Stage area LTBPFY23LOCALRUNTEST successfully created.
INFO:root:adls snowflake stage query 
    select
    $1:"ECID"::varchar as ECID
, $1:"SEASONYEAR"::varchar as SEASONYEAR
, $1:"AGE"::varchar as AGE
, $1:"AVGVISITPERSEASON"::varchar as AVGVISITPERSEASON
, $1:"BOUGHTPASS"::varchar as BOUGHTPASS
, $1:"DESTINATIONGEOAFINITYLABEL"::varchar as DESTINATIONGEOAFINITYLABEL
, $1:"EVERCOREPASS"::varchar as EVERCOREPASS
, $1:"EVERPASS"::varchar as EVERPASS
, $1:"GENDERCODE"::varchar as GENDERCODE
, $1:"GUESTBEHAVIOR"::varchar as GUESTBEHAVIOR
, $1:"ISEPICMIXACTIVATED"::varchar as ISEPICMIXACTIVATED
, $1:"MARKETINGZONE"::varchar as MARKETINGZONE
, $1:"MOSTCOMMONTICKETCOMP"::varchar as MOSTCOMMONTICKETCOMP
, $1:"MOSTSUBSEASONVISITED"::varchar as MOSTSUBSEASONVISITED
, $1:"MOSTVISITEDREGION"::varchar as MOSTVISITEDREGION
, $1:"MOSTVISITEDRESORT"::varchar as MOSTVISITEDRESORT
, $1:"ONLYSINGLERESORTKEY"::varchar as ONLYSINGLERESORTKEY
, $1:"PARTNERRESORTSCANNERFLAG"::varchar as PARTNERRESORTSCANNERFLAG
, $1:"RESORTSVISITED"::varchar as RESORTSVISITED
, $1:"SKIERABILITYLABEL"::varchar as SKIERABILITYLABEL
, $1:"SUBSEASONSPERYEAR"::varchar as SUBSEASONSPERYEAR
, $1:"TOTALSEASONSSCANNED"::varchar as TOTALSEASONSSCANNED
, $1:"TOTALVISITS"::varchar as TOTALVISITS
, $1:"VISITMOSTINPEAK"::varchar as VISITMOSTINPEAK

    from @ltbpFY23LocalRunTest/inference_data/
    LIMIT 1000
    </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:Preview dataframe queried        ECID SEASONYEAR  AGE  ... TOTALSEASONSSCANNED TOTALVISITS VISITMOSTINPEAK
0   5224121    2021/22   64  ...                   0           0               0
1  65773479    2021/22   23  ...                   0           0               0
2  57541763    2021/22  119  ...                   0           0               0
3  49372383    2021/22   46  ...                   0           0               0
4  58111328    2021/22    5  ...                   0           0               0

[5 rows x 24 columns]
INFO:root:Loading Sklearn Object to: ./models/train_xgb_basicLocalRunTestNOHYPEROPT.pkl
INFO:data_system_utilities.azure.storage:Downloading projects/LTBP/FY23/experiments/NOHYPEROPT/modeling/train_xgb_basic/train_xgb_basicLocalRunTestNOHYPEROPT.pkl to ./models/train_xgb_basicLocalRunTestNOHYPEROPT.pkl
INFO:data_system_utilities.azure.storage:Download complete
INFO:root:Sklearn Object Loaded
INFO:root:preview predictions being added:
       ECID SEASONYEAR  ...         DATE_CREATED  EXPERIMENT
0   5224121    2021/22  ...  2022-11-04 07:54:33  NOHYPEROPT
1  65773479    2021/22  ...  2022-11-04 07:54:33  NOHYPEROPT
2  57541763    2021/22  ...  2022-11-04 07:54:33  NOHYPEROPT

[3 rows x 6 columns]
INFO:root:preview predictions values addes:
['5224121' '2021/22' 0.060644448 'LocalRunTest' '2022-11-04 07:54:33'
 'NOHYPEROPT']
INFO:root:preview predictions being added columns:
Index(['ECID', 'SEASONYEAR', 'PROBABILITY', 'CI_COMMIT_SHA', 'DATE_CREATED',
       'EXPERIMENT'],
      dtype='object')
INFO:data_system_utilities.azure.storage:Uploading predictions_LocalRunTestNOHYPEROPT.csv, to Azure Storage projects/LTBP/FY23/LocalRunTest/NOHYPEROPT/predictions/train_xgb_basic/predictions_LocalRunTestNOHYPEROPT.csv
INFO:data_system_utilities.azure.storage:Azure Upload Complete
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:Pushing Forecasted Season from ADLS to Snowflake
INFO:data_system_utilities.snowflake.copyinto:
copy into MACHINELEARNINGOUTPUTS.LTBP.LTBP_PREDICTIONS_FY23
from 'azure://vaildtscadls.blob.core.windows.net/vailadls/projects/LTBP/FY23/LocalRunTest/NOHYPEROPT/predictions/train_xgb_basic/predictions_LocalRunTestNOHYPEROPT.csv'
file_format = (type = csv     skip_header = 1)
credentials= (azure_sas_token = '?sv=2019-12-12&amp;ss=bfqt&amp;srt=sco&amp;sp=rwdlacupx&amp;se=2031-01-22T06:17:14Z&amp;st=2021-01-21T22:17:14Z&amp;spr=https&amp;sig=kIHogByJjyVWyL6XupA0CBUB1iw12%2FeXWFQiOj5fB5c%3D')
pattern = '.*.csv';
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:root:preview of queried table being added:
       ECID SEASONYEAR  ...         DATE_CREATED  EXPERIMENT
0   5224121    2021/22  ...  2022-11-04 07:54:33  NOHYPEROPT
1  65773479    2021/22  ...  2022-11-04 07:54:33  NOHYPEROPT
2  57541763    2021/22  ...  2022-11-04 07:54:33  NOHYPEROPT

[3 rows x 6 columns]
INFO:root:preview predictions values addes:
['5224121' '2021/22' 0.060644448 'LocalRunTest' '2022-11-04 07:54:33'
 'NOHYPEROPT']</code></pre>
</div>
</div>
<section id="results-3" class="level3">
<h3 class="anchored" data-anchor-id="results-3">Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT * </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.LTBP.LTBP_PREDICTIONS_FY23</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY DATE_CREATED DESC</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ECID</th>
      <th>SEASONYEAR</th>
      <th>PROBABILITY</th>
      <th>CI_COMMIT_SHA</th>
      <th>DATE_CREATED</th>
      <th>EXPERIMENT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49372383</td>
      <td>2021/22</td>
      <td>0.020070</td>
      <td>LocalRunTest</td>
      <td>2022-11-04 07:54:33</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>65773479</td>
      <td>2021/22</td>
      <td>0.028624</td>
      <td>LocalRunTest</td>
      <td>2022-11-04 07:54:33</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5224121</td>
      <td>2021/22</td>
      <td>0.060644</td>
      <td>LocalRunTest</td>
      <td>2022-11-04 07:54:33</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>58111328</td>
      <td>2021/22</td>
      <td>0.028791</td>
      <td>LocalRunTest</td>
      <td>2022-11-04 07:54:33</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>4</th>
      <td>57541763</td>
      <td>2021/22</td>
      <td>0.037379</td>
      <td>LocalRunTest</td>
      <td>2022-11-04 07:54:33</td>
      <td>NOHYPEROPT</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT DISTINCT CI_COMMIT_SHA, DATE_CREATED, EXPERIMENT</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.LTBP.LTBP_PREDICTIONS_FY23</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY DATE_CREATED DESC</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CI_COMMIT_SHA</th>
      <th>DATE_CREATED</th>
      <th>EXPERIMENT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LocalRunTest</td>
      <td>2022-11-04 07:54:33</td>
      <td>NOHYPEROPT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>LocalRunTest</td>
      <td>2022-11-04 07:54:23</td>
      <td>BASELINE</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If this table populates you can think about how an post analysis experiment could work meaning you can do a prediction average ensemble between the models that are production level and weigh them depending on your confidence there is also an ensemble trainer that can be used, but isn’t covered here</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>sf.run_sql_str(<span class="st">'''SELECT ECID, COUNT(1) Total</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MACHINELEARNINGOUTPUTS.LTBP.LTBP_PREDICTIONS_FY23</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY ECID</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="st">HAVING COUNT(1) &gt; 2</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ECID</th>
      <th>TOTAL</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="want-to-restart" class="level1">
<h1>Want to Restart?</h1>
<p>Here are all the commands to start over</p>
<p>TODO: put all the tear down commands to this here</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sf.run_sql_str('DROP TABLE MACHINELEARNINGOUTPUTS.DEV.LTBP_PREDICTIONS_FY23')</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sf.run_sql_str('DROP TABLE MACHINELEARNINGOUTPUTS.LTBP.LTBP_MODEL_TRACKING_FY23')</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sf.run_sql_str('DROP TABLE MACHINELEARNINGOUTPUTS.LTBP.LTBP_PREDICTIONS_FY23')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:LTBP_PREDICTIONS_FY23 successfully dropped.
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:LTBP_MODEL_TRACKING_FY23 successfully dropped.
INFO:data_system_utilities.snowflake.utils:connection to snowflake established...
INFO:data_system_utilities.snowflake.query:executing query
INFO:data_system_utilities.snowflake.query:data loaded from snowflake
INFO:data_system_utilities.snowflake.query:connection to snowflake has been turned off
INFO:data_system_utilities.snowflake.query:LTBP_PREDICTIONS_FY23 successfully dropped.</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LTBP_PREDICTIONS_FY23 successfully dropped.</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>